(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{50:function(e){e.exports={userId:"e8ca5f09-ffa1-43d8-9f28-867ed8ad876a",accessToken:"A3vPGtynREZwCpUNrCRN0sNJqitzG0wnqTJdRXOhUcYZcUjUZv2eFaoaE1DKtA2_QxRdFgLihrNhm6iHFGcyJnhRoYQnbkELrJUSTNHcRadSwgtgjlDdaI-LWyAHUZkZGYfaGC1svaQb-SQNb7DhrTG7p-gVnOWkrah2WJJDePBUOg2PSblyFwg8Ir35buFDllBlBH3YFg0ybSoIS0wVi_v8a4OFrZT1eGE4l9-Sn4ux5P9ArtiaQETZnZZw:feedlydev",feedlyUrl:"https://cloud.feedly.com/v3"}},5460:function(e,t,n){e.exports=n(5667)},5645:function(e,t){},5667:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(23),i=n.n(c),o=n(30),u=n(14),s=n(63),l=n(5672),f=n(3),d=n.n(f),p=n(21),m=n(6),v=n(158),h=n.n(v),b=n(50),g=function(e){var t={};for(var n in e||{})t[n]=e[n];return h.a.stringify(t)},y=function(){var e=Object(m.a)(d.a.mark(function e(t,n){var r,a,c,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=g(n),a=0===r.length?"":t.includes("?")?"&":"?",c="".concat(b.feedlyUrl).concat(t).concat(a).concat(r),e.next=5,fetch("".concat("https://cors-anywhere.herokuapp.com/").concat(c),{method:"GET",headers:{Authorization:"OAuth ".concat(b.accessToken)}});case 5:if((i=e.sent).ok){e.next=8;break}throw i;case 8:return e.abrupt("return",i.json());case 9:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),E={unreadOnly:!0},O=function(){var e=Object(m.a)(d.a.mark(function e(t){var n,r,a=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"contents",r=a.length>2?a[2]:void 0,e.abrupt("return",y("".concat("/streams","/").concat(n,"?streamId=").concat(t),Object(p.a)({},E,r)));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),x=function(e){return"user/".concat(e,"/category/global.all")},k=function(e){return"user/".concat(e,"/tag/global.saved")},w=n(4),j=n(22),S=n(13),A=Object(u.a)({"@global":{".nested-list *":{paddingLeft:"40px"}}}),C=function(e){A();var t=Object(r.useState)(e.defaultOpen),n=Object(S.a)(t,2),a=n[0],c=n[1];return r.createElement(r.Fragment,null,e.header({open:a,toggle:function(){return c(!a)}}),r.createElement(w.g,{in:a,timeout:"auto",unmountOnExit:!0},r.createElement(w.n,{disablePadding:!0,className:"nested-list"},e.children)))},I=n(5671),T=Object(I.a)(function(e){return r.createElement(w.o,{button:!0,onClick:function(){return e.history.push("/stream/".concat(e.feed.feedId))}},r.createElement(w.r,null,e.feed.title))}),F=Object(I.a)(function(e){return r.createElement(C,{defaultOpen:!0,header:function(t){return r.createElement(w.o,{button:!0,onClick:function(){return e.history.push("/stream/".concat(e.collection.id))}},r.createElement(w.p,null,r.createElement(j.g,null)),r.createElement(w.r,null,e.collection.label),r.createElement("div",{onClick:function(e){t.toggle(),e.stopPropagation()}},t.open?r.createElement(j.a,null):r.createElement(j.b,null)))}},e.collection.feeds.map(function(e){return r.createElement(T,{key:e.id,feed:e})}))}),N=n(44),R=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];Object(r.useEffect)(function(){e.apply(void 0,n)},[].concat(n))},U=[],L=N.store,P=function(){return L};window.getStore=P,Object(N.afterChange)(function(e){e.store!==e.prevStore&&(L=e.store,U.forEach(function(t){return t(e.store)}))});var B=function(){var e=Object(r.useState)(N.store),t=Object(S.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)(function(){var e=function(e){return U.push(e),e}(a);return function(){!function(e){var t=U.indexOf(e);U.splice(t,1)}(e)}}),n},z=n(26),H=n(35),M=n(51),J=n.n(M);window.localForage=J.a;var q,W,D=function(e,t){return J.a.setItem(e,JSON.stringify(t))},Z=function(e){return D("".concat("entries",".").concat(e.id),e)},G=function(e,t){return J.a.getItem(e).then(function(){var t=Object(m.a)(d.a.mark(function t(n){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Set,t.next=3,Q(e);case 3:return t.t1=t.sent,t.abrupt("return",new t.t0(t.t1));case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()).then(function(n){return[].concat(Object(H.a)(Object.keys(t).map(function(r){return n.add(r),D("".concat(e,".").concat(r),t[r])})),[D(e,Array.from(n))])})},_=function(){var e=Object(m.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,J.a.getItem(t);case 3:return e.t1=e.sent,e.abrupt("return",e.t0.parse.call(e.t0,e.t1));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(m.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(t);case 2:return n=e.sent,e.abrupt("return",Array.isArray(n)?n:[]);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(m.a)(d.a.mark(function e(t){var n,r,a,c,i=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:20,e.next=3,Q(t);case 3:r=e.sent,a=0;case 5:if(!(a<r.length)){e.next=13;break}return e.next=8,Promise.all(r.slice(a,Math.min(a+n,r.length)).map(function(e){return _("".concat(t,".").concat(e))}));case 8:c=e.sent,P()[t]=Object(p.a)({},P()[t],c.reduce(function(e,t){return Object(p.a)({},e,Object(z.a)({},t.id,t))},{}));case 10:a+=n,e.next=5;break;case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(m.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(t);case 2:return n=e.sent,P[t]=n,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(m.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Y("entries"),Y("streams")]);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),K=function(){var e=Object(m.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",y("".concat("/collections","/")));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),$=function(){var e=Object(m.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!P().updating.collections){e.next=2;break}return e.abrupt("return");case 2:return P().updating.collections=!0,t=!P().collections,e.next=6,V("collections");case 6:if((n=e.sent)&&(P().collections=n),!t){e.next=22;break}return e.prev=9,e.next=12,K();case 12:return n=e.sent,P().collections=n,e.next=16,D("collections",n);case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(9),window.snackHelper.enqueueSnackbar("Unable to fetch collections. You appear to be offline."),P().collections=[];case 22:delete P().updating.collections;case 23:case"end":return e.stop()}},e,this,[[9,18]])}));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(m.a)(d.a.mark(function e(){var t,n=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]&&n[0],!P().updating.profile){e.next=3;break}return e.abrupt("return");case 3:return q=te(t),P().updating.profile=!0,e.next=7,q;case 7:P().profile=e.sent,P().updating.profile=!1;case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),te=function(){var e=Object(m.a)(d.a.mark(function e(){var t,n=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=n.length>0&&void 0!==n[0]&&n[0])||!q){e.next=3;break}return e.abrupt("return",q);case 3:return q=ne(t),e.abrupt("return",q);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=Object(m.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=4;break}return e.next=3,V("profile");case 3:n=e.sent;case 4:if(n){e.next=10;break}return e.next=7,y("/profile");case 7:return n=e.sent,e.next=10,D("profile",n);case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=B();return Object(r.useEffect)(function(){e.profile||ee()},[]),e.profile},ae=Object(I.a)(function(e){return r.createElement(w.o,{onClick:function(){return e.history.push("/stream/".concat(e.categoryId))},button:!0},r.createElement(w.p,null,r.createElement(j.g,null)),r.createElement(w.r,null,e.text))}),ce=function(e){var t=re(),n=function(){var e=B();return R($),e.collections?Object.values(e.collections):[]}();return r.createElement(r.Fragment,null,r.createElement(ae,{text:"All",categoryId:x(t&&t.id)}),r.createElement(ae,{text:"Saved",categoryId:k(t&&t.id)}),n.map(function(e){return r.createElement(F,{collection:e,key:e.id})}))},ie=function(e){var t=Object(r.useState)(!1),n=Object(S.a)(t,2),c=n[0],i=n[1];return a.a.createElement("div",null,a.a.cloneElement(e.trigger,{onClick:function(){return i(!0)}}),a.a.createElement(w.i,{open:c,onClose:function(){return i(!1)}},a.a.createElement("div",{style:{width:"250px",margin:"10px"}},a.a.createElement(w.w,{variant:"h5"},"Progrssive Reader"),a.a.createElement(w.n,null,a.a.createElement(w.o,{button:!0},a.a.createElement(w.p,null,a.a.createElement(j.d,null)),a.a.createElement(w.r,{primary:"Login"}))),a.a.createElement(ce,null))))},oe=(a.a.createContext(void 0),Object(u.a)({pageActions:{flex:1,display:"flex",flexDirection:"row-reverse",width:"100%"}})),ue=function(e){var t=oe();return a.a.createElement(w.a,{position:"static",color:"primary"},a.a.createElement(w.v,null,a.a.createElement(ie,{trigger:a.a.createElement(w.l,null,a.a.createElement(j.c,null))}),a.a.createElement(w.w,{variant:"title"},"Progrssive"),a.a.createElement("div",{className:t.pageActions,id:"app-bar-button-container"})))},se=(n(5645),Object(s.withSnackbar)(function(e){return window.snackHelper=e,null})),le=n(161),fe=n(165),de=function(e){return"".concat(e.engagement?e.engagement+" ":"").concat(e.origin&&e.origin.title," / ").concat(Object(fe.a)(new Date(e.published)))},pe=function(){var e=Object(m.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y("/entries/".concat(encodeURIComponent(t)));case 2:return n=e.sent,e.abrupt("return",n[0]);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=Object(m.a)(d.a.mark(function e(t){var n,r,a,c=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]&&c[1],!P().updating[t]){e.next=3;break}return e.abrupt("return");case 3:if(P().updating[t]=!1,e.t1=!n,!e.t1){e.next=9;break}return e.next=8,i=t,_("".concat("entries",".").concat(i));case 8:e.t1=e.sent;case 9:if(e.t0=e.t1,e.t0){e.next=14;break}return e.next=13,pe(t);case 13:e.t0=e.sent;case 14:r=e.t0,(a=P()).entries=Object(p.a)({},a.entries,Object(z.a)({},t,r)),delete a.updating[t];case 18:case"end":return e.stop()}var i},e,this)}));return function(t){return e.apply(this,arguments)}}(),ve=function(e){var t=Object(r.useState)(void 0),n=Object(S.a)(t,2),a=n[0],c=n[1];return Object(r.useEffect)(function(){c(document.getElementById("app-bar-button-container"))},[]),a?i.a.createPortal(e.children,a):null},he=function(){var e=Object(m.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n="/markers",r=t,fetch("".concat("https://cors-anywhere.herokuapp.com/").concat(b.feedlyUrl).concat(n),{method:"POST",headers:{Authorization:"OAuth ".concat(b.accessToken),"Content-Type":"application/json"},body:JSON.stringify(r)});case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),e.next=9,Ee(t);case 9:case"end":return e.stop()}var n,r},e,this,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),be=function(){var e=Object(m.a)(d.a.mark(function e(t){var n,r,a=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],t=Array.isArray(t)?t:[t],r={type:"entries",action:n?"keepUnread":"markAsRead",entryIds:t.map(function(e){return e.id})},e.next=5,he(r);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),ge=function(){var e=Object(m.a)(d.a.mark(function e(t){var n,r,a=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],r={type:"entries",action:n?"markAsSaved":"markAsUnsaved",entryIds:[t.id]},e.next=4,he(r);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),ye=function(){var e=Object(m.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("markers-for-online",W);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),Ee=function(){var e=Object(m.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(W){e.next=4;break}return e.next=3,Oe();case 3:W=e.sent;case 4:return W.push(t),e.next=7,ye();case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),Oe=function(){var e=Object(m.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_("markers-for-online");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();Object(m.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(){var e=Object(m.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=W.map(he),W.length=0,e.next=4,ye();case 4:return e.next=6,Promise.all(t);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),e.next=3,Oe();case 3:if(W=e.sent,!navigator.onLine){e.next=7;break}return e.next=7,t();case 7:window.addEventListener("online",t);case 8:case"end":return e.stop()}},e,this)}))();var xe=function(){var e=Object(m.a)(d.a.mark(function e(t,n){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.unread=n,e.next=3,be(t,t.unread);case 3:return e.next=5,Z(t);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),ke=function(){var e=Object(m.a)(d.a.mark(function e(t,n,r){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=k(r),t.tags=n?[].concat(Object(H.a)(t.tags||[]),[{id:a,label:"Saved For Later"}]):t.tags.filter(function(e){return e.id!==a}),e.next=4,ge(t,n);case 4:return e.next=6,Z(t);case 6:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}(),we=Object(u.a)({on:{color:"white !important"},off:{color:"gray !important"}}),je=function(e){var t=we(),n=Object(r.useCallback)(function(){xe(e.entry,!e.entry.unread)},[e.entry,e.entry.unread]);return r.createElement(w.l,{className:e.entry.unread?t.on:t.off,onClick:n},r.createElement(j.f,null))},Se=function(e){var t,n=we(),a=re(),c=(t=e.entry).tags&&t.tags.some(function(e){return e.id.endsWith("global.saved")}),i=Object(r.useCallback)(function(){ke(e.entry,!c,a.id)},[e.entry,c]);return r.createElement(w.l,{className:n.on,onClick:i},c?r.createElement(j.h,null):r.createElement(j.i,null))},Ae=function(e,t){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:200,c=0;return Object(r.useCallback)(function(){c++,setTimeout(function(){return c--},a),c>=n&&e.apply(void 0,arguments)},[].concat(Object(H.a)(t),[n,a]))}(e,t,2,arguments.length>2&&void 0!==arguments[2]?arguments[2]:200)},Ce=function(e){return function(e){var t=Object(r.useState)(!1),n=Object(S.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)(void 0),o=Object(S.a)(i,2),u=o[0],s=o[1];return Object(r.useCallback)(function(t){clearTimeout(u),a||(c(!0),e.onStart&&e.onStart()),e.onScroll&&e.onScroll();var n=setTimeout(function(){c(!1),e.onEnd&&e.onEnd()},100);s(n)},[e,a,u])}({onEnd:e})},Ie=Object(u.a)({root:{maxWidth:"1000px",marginLeft:"auto",marginRight:"auto"},"@global":{"article img":{width:"100%"},"article figure":{margin:0}}}),Te=Object(I.a)(function(e){var t=B(),n=Ie(),a=function(){var e=Object(u.b)();return!!e&&!Object(le.unstable_useMediaQuery)(e.breakpoints.up("md")).valueOf()}(),c=Object(r.useRef)(null),i=t.entries[e.id];Object(r.useEffect)(function(){!i&&e.id&&me(e.id)},[e.id]),function(e){var t=B().settings.markOpenedAsRead;Object(r.useEffect)(function(){e&&e.unread&&t&&xe(e,!1)},[e&&e.id,t])}(i),function(e,t){Object(r.useEffect)(function(){e&&t&&t.current&&t.current.parentElement.scrollTo(0,0)},[e&&e.id])}(i,c);var o=Ae(function(n){t.settings.doubleTapToCloseArticles&&(e.history.goBack(),n.stopPropagation(),document.getSelection().removeAllRanges())},[]);if(!i)return r.createElement(w.f,null);var s=function(e){var t=e.content||e.summary;return t&&t.content}(i),l=r.createElement(r.Fragment,null,r.createElement(w.d,{title:i.title,subheader:de(i)}),s&&r.createElement(w.c,null,r.createElement(w.w,{component:"small"},r.createElement("div",{dangerouslySetInnerHTML:{__html:s}}))));return r.createElement("article",{className:n.root,ref:c,onClick:o},a?l:r.createElement(w.b,null,l),e.active&&r.createElement(r.Fragment,null,r.createElement(ve,null,r.createElement(je,{entry:i})),r.createElement(ve,null,r.createElement(Se,{entry:i}))))}),Fe=n(5669),Ne=function(e){var t=Array.isArray(e.children)?e.children:[e.children],n=Object(r.useRef)(null),a=Object(r.useState)(e.activeIndex||0),c=Object(S.a)(a,2),i=c[0],o=c[1];Object(r.useEffect)(function(){if(!isNaN(e.activeIndex)&&i!==e.activeIndex&&n.current){if(e.activeIndex<0||n.current&&e.activeIndex>n.current.children.length)throw new Error("Index ".concat(e.activeIndex," out of range!"));var t=n.current.children[e.activeIndex];n.current.scrollTo(t.offsetLeft,0),o(e.activeIndex)}},[e.activeIndex]);var u=Ce(function(){for(var t,r=n.current,a=1/0,c=0;c<r.children.length;++c){var u=r.children[c],s=Math.abs(r.scrollLeft-u.offsetLeft);s<a&&(a=s,t=c)}void 0!==t&&t!==i&&(o(t),e.onSwiped&&e.onSwiped(t))});return r.createElement("div",{style:{scrollSnapType:"x mandatory",overflowX:"scroll",display:"flex",scrollbarWidth:"none"},onScroll:u,ref:n},t.map(function(e,t){return r.createElement("div",{key:t,style:{flexShrink:0,scrollSnapAlign:"start",scrollSnapStop:"always"}},e)}))},Re=function(e){return r.createElement(Fe.a,{path:"".concat(e.prefix,":id*"),component:function(t){var n=t.location.pathname.substr(e.prefix.length);return e.setActive(e.prefix,n),null}})},Ue=Object(I.a)(function(e){var t=B(),n=Object(r.useState)(0),a=Object(S.a)(n,2),c=a[0],i=a[1],o=Object(r.useCallback)(function(n,r){t.current[n]=r;var a=e.routes.findIndex(function(e){return e.prefix===n});i(a)},[e.routes,i]);return r.createElement(r.Fragment,null,r.createElement(Ne,{activeIndex:c,onSwiped:function(n){if(n!==c){var r=e.routes[n].prefix,a=t.current[r];i((n+1)%2),e.history.push("".concat(r).concat(a||""))}}},e.routes.map(function(e,n){return r.createElement("div",{style:{width:"100vw",height:"90vh",overflow:"hidden auto",paddingTop:"10px"},key:e.prefix},e.render(t.current[e.prefix],c===n))})),e.routes.map(function(e){return r.createElement(Re,{key:e.prefix,prefix:e.prefix,setActive:o})}),r.createElement(Fe.a,{path:"/",exact:!0,component:function(){return i(1),null}}))}),Le=n(163),Pe=function(e,t){var n;return function(){for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];clearTimeout(n),n=setTimeout(function(){return e.apply(void 0,a)},t)}},Be={markOpenedAsRead:!0,markScrolledAsRead:!0,doubleTapToCloseArticles:!0,unreadOnly:!0,fontSize:3,darkMode:!1},ze=Pe(function(e){window.localStorage.setItem("settings",JSON.stringify(e)),console.log("saved settings!")},1e3),He=function(e,t){P().settings[e]=t,ze(P().settings)},Me=Object(u.a)({slider:{width:"48px !important"}}),Je=function(e){var t=Me(),n=B(),a=r.useCallback(function(e,t){var n=e.target.name;He(n,t)},[]),c=Object(r.useCallback)(function(e,t){He("fontSize",t)},[]);return r.createElement("div",null,r.createElement(w.n,null,r.createElement(w.o,null,r.createElement(w.r,{primary:"Read opened articles",secondary:"Marks articles as read when you open them."}),r.createElement(w.q,null,r.createElement(w.u,{checked:n.settings.markOpenedAsRead,name:"markOpenedAsRead",onChange:a}))),r.createElement(w.o,null,r.createElement(w.r,{primary:"Auto mark as read",secondary:"Marks articles as read when you scoll past them."}),r.createElement(w.q,null,r.createElement(w.u,{checked:n.settings.markScrolledAsRead,name:"markScrolledAsRead",onChange:a}))),r.createElement(w.o,null,r.createElement(w.r,{primary:"Double tap to close articles",secondary:"Whether articles can be closed by double tapping them."}),r.createElement(w.q,null,r.createElement(w.u,{checked:n.settings.doubleTapToCloseArticles,name:"doubleTapToCloseArticles",onChange:a}))),r.createElement(w.h,null),r.createElement(w.o,null,r.createElement(w.r,{primary:"Article Text Size",secondary:"Controls the size of the article text"}),r.createElement(w.q,null,r.createElement(Le.a,{className:t.slider,min:1,max:5,step:1,onChange:c,value:n.settings.fontSize})))))},qe=Object(u.a)({paper:{cursor:"pointer",position:"relative"},card:{maxHeight:"500px"},read:{color:"#F0F0F0 !important"},unread:{},tint:{background:"#FFFFFF",opacity:.6,top:"0",left:"0",bottom:"0",right:"0",position:"absolute"}}),We=function(e){var t,n=qe(),r=(t=e.entry).visual&&t.visual.url,c=de(e.entry),i=function(e){return e.summary&&e.summary.content}(e.entry),o=!e.entry.unread&&e.showingUnreadOnly;return a.a.createElement(w.s,{className:n.paper},a.a.createElement(w.b,{className:n.card},a.a.createElement(w.d,{title:e.entry.title,subheader:c}),r&&a.a.createElement(w.e,{src:r,component:"img",title:"Visual"}),i&&a.a.createElement(w.c,null,a.a.createElement(w.w,{component:"small"},a.a.createElement("div",{dangerouslySetInnerHTML:{__html:i}})))),o&&a.a.createElement("div",{className:n.tint}))},De=N.store,Ze=function(e,t){var n,r="user/".concat(e,"/category/global.uncategorized"),a=k(e),c={},i=(n={},Object(z.a)(n,t.id,Object(p.a)({},t,{items:t.items.map(function(e){return e.id}),lastFetched:Date.now()})),Object(z.a)(n,r,{id:r,title:"Uncategorized",items:[],lastFetched:0}),Object(z.a)(n,a,{id:a,title:"Saved for later",items:[],lastFetched:0}),n),o=!0,u=!1,s=void 0;try{for(var l,f=t.items[Symbol.iterator]();!(o=(l=f.next()).done);o=!0){var d=l.value;if(c[d.id]=d,d.categories&&0!==d.categories.length){var m=!0,v=!1,h=void 0;try{for(var b,g=d.categories[Symbol.iterator]();!(m=(b=g.next()).done);m=!0){var y=b.value;if(!i[y.id]){var E=De.streams[y.id];i[y.id]={id:y.id,title:y.label,items:Object(H.a)(E?E.items:[]),lastFetched:E?E.lastFetched:0}}i[y.id].items.push(d.id)}}catch(j){v=!0,h=j}finally{try{m||null==g.return||g.return()}finally{if(v)throw h}}}else i[r].items.push(d.id)}}catch(j){u=!0,s=j}finally{try{o||null==f.return||f.return()}finally{if(u)throw s}}for(var O=Object.values(i),x=0;x<O.length;x++){var w=O[x];w.items=Array.from(new Set(w.items))}De.entries=Object(p.a)({},De.entries,c),De.streams=Object(p.a)({},De.streams,i),Promise.all([G("streams",i),G("entries",c)])},Ge=function(){var e=Object(m.a)(d.a.mark(function e(t){var n,r,a,c=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]&&c[1],r=c.length>2&&void 0!==c[2]&&c[2],P().profile){e.next=5;break}return e.next=5,ee();case 5:if(t=t||x(P().profile.id),!P().updating[t]){e.next=8;break}return e.abrupt("return");case 8:return P().updating[t]=!0,e.prev=9,e.next=12,O(t,"contents",{unreadOnly:n});case 12:a=e.sent,Ze(P().profile.id,a),r&&_e(),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(9),window.snackHelper.enqueueSnackbar("Unable to update stream. You appear to be offline.");case 20:P().updating[t]=!1;case 21:case"end":return e.stop()}},e,this,[[9,17]])}));return function(t){return e.apply(this,arguments)}}(),_e=function(){var e=Object(m.a)(d.a.mark(function e(){var t,n,r,a,c,i=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:void 0,e.next=3,te();case 3:n=e.sent,r=x(n.id),e.prev=5;case 6:return a={unreadOnly:!0},t&&(a.continuation=t),e.next=10,O(r,"contents",a);case 10:c=e.sent,t=c.continuation,Ze(n.id,c);case 13:if(t){e.next=6;break}case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),window.snackHelper.enqueueSnackbar("Background update failed.");case 19:window.snackHelper.enqueueSnackbar("Background sync complete.");case 20:case"end":return e.stop()}},e,this,[[5,16]])}));return function(){return e.apply(this,arguments)}}(),Qe=Object(u.a)({root:{display:"flex",justifyContent:"center"}}),Ye=function(e){var t=Qe();return r.createElement("div",{className:t.root},e.children)},Ve=function(e){var t=Object(r.useRef)(null),n=Object(r.useState)(null),a=Object(S.a)(n,2),c=a[0],i=a[1],o=Object(r.useState)(null),u=Object(S.a)(o,2),s=u[0],l=u[1],f=Object(r.useState)(!1),d=Object(S.a)(f,2),p=d[0],m=d[1];return r.useEffect(function(){if(t&&t.current){c&&s&&c.removeEventListener("scroll",s);var n=Pe(function(e){var n=function(e,t){if(!e||!t)return!1;var n=t.getBoundingClientRect(),r=e.getBoundingClientRect();return n.bottom<r.top}(c,t.current);n!==p&&m(n)},1e3),r=e.getContainer(t.current);return i(r),l(n),r.addEventListener("scroll",n,{passive:!0}),function(){c&&s&&c.removeEventListener("scroll",s)}}},[e.getContainer,t]),r.createElement(w.t,{rootRef:t},e.children(!p))},Xe=n(164),Ke=Object(u.a)({stickyHeader:{position:"sticky",top:0}}),$e=function(e){var t=Ke(),n=e.children,a=e.className,c=Object(Xe.a)(e,["children","className"]);return r.createElement("div",Object.assign({className:"".concat(a," ").concat(t.stickyHeader)},c),n)},et=Object(u.a)({root:{},loadingButton:{color:"white !important"},loader:{marginBottom:"10px"},header:{top:"-10px",zIndex:1e3,margin:"-10px -10px 10px -10px"}}),tt=function(e){return Object(r.useEffect)(function(){e.entry&&e.entry.unread&&xe(e.entry,!1)},[e.entry&&e.entry.id]),null},nt=Object(I.a)(function(e){var t=e.id,n=function(e){var t=B();if(e){var n=t.streams;if(e.startsWith("feed/"))return{id:e,items:Object.values(t.entries).filter(function(t){return t.origin.streamId===e}),title:"Feed"};if(e.includes("/tag/"))return{id:e,items:Object.values(t.entries).filter(function(t){return t.tags&&t.tags.some(function(t){return t.id===e})}),title:"Tag"};var r=n[e];return r?Object(p.a)({},r,{items:r.items.map(function(e){return t.entries[e]})}):void 0}}(t);return Object(r.useEffect)(function(){!t||n&&n.id!==t||Ge(t)},[t]),a.a.createElement(rt,{entries:n&&n.items,id:t,history:e.history,active:e.active})}),rt=function(e){var t,n=B(),c=et(),i=n.settings.markScrolledAsRead,o=!e.entries||(t=e.id,L.updating[t]),u=Object(r.useState)({}),s=Object(S.a)(u,2),l=s[0],f=s[1],d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.entries)return[];var r=e.entries.filter(function(e){return e&&(e.unread||!n.settings.unreadOnly||t[e.id])});return r.sort(function(e,t){return t.published-e.published}),r};Object(r.useEffect)(function(){f(d().reduce(function(e,t){return e[t.id]=!0,e},{}))},[e.id,n.settings.unreadOnly]);var p=Object(r.useMemo)(function(){return d(l)},[e.entries,e.id,n.settings.unreadOnly,n.updating[e.id],l]),m=100*(1-Object(r.useMemo)(function(){return p.filter(function(e){return e.unread}).length},[e.entries])/p.length);return a.a.createElement("div",{className:c.root},n.settings.unreadOnly&&!!p.length&&a.a.createElement($e,{className:c.header},a.a.createElement(w.m,{variant:"determinate",value:m,color:"secondary"})),o&&a.a.createElement(Ye,null,a.a.createElement(w.f,{className:c.loader})),a.a.createElement(w.k,{spacing:24,container:!0,justify:"center",wrap:"wrap"},p.map(function(t){return a.a.createElement(Ve,{key:t.id,getContainer:function(e){return e.parentElement.parentElement.parentElement}},function(r){return a.a.createElement(w.k,{item:!0,lg:3,md:6,sm:6,xs:12,onClick:function(){return e.history.push("/entries/".concat(t.id))}},a.a.createElement(We,{entry:t,showingUnreadOnly:n.settings.unreadOnly}),!r&&i&&a.a.createElement(tt,{entry:t}))})})),e.active&&a.a.createElement(a.a.Fragment,null,a.a.createElement(ve,null,a.a.createElement(w.l,{disabled:o,onClick:function(){return Ge(e.id,!1,!0)}},a.a.createElement(j.e,null))),a.a.createElement(ve,null,a.a.createElement(w.j,{control:a.a.createElement(w.u,{checked:n.settings.unreadOnly,onClick:function(){return n.settings.unreadOnly=!n.settings.unreadOnly}}),label:"Unread"}))))},at=Object(u.a)({root:{width:"100vw",height:"100vw"}}),ct=[{prefix:"/settings/",render:function(){return a.a.createElement(Je,null)}},{prefix:"/stream/",render:function(e,t){return a.a.createElement(nt,{id:e,active:t})}},{prefix:"/entries/",render:function(e,t){return a.a.createElement(Te,{id:e,active:t})}}];_e();var it=function(e){var t=at(),n=B(),c=re(),i=Object(r.useMemo)(function(){return e=n.settings,Object(o.createMuiTheme)({palette:{type:e.darkMode?"dark":"light",primary:{main:"#2BB24C"}},typography:{fontSize:8+2*e.fontSize}});var e},[n.settings.fontSize]);return Object(r.useEffect)(function(){!n.current["/stream/"]&&c&&(n.current["/stream/"]=x(c.id))},[n.current,c]),a.a.createElement(l.a,null,a.a.createElement(o.MuiThemeProvider,{theme:i},a.a.createElement(s.SnackbarProvider,null,a.a.createElement(se,null),a.a.createElement("div",{className:t.root},a.a.createElement(ue,null),a.a.createElement(Ue,{routes:ct})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));De.streams={},De.entries={},De.updating={categories:!1,profile:!1},De.settings=function(){var e=window.localStorage.getItem("settings");return e?JSON.parse(e):Be}(),De.current={},X(),i.a.render(a.a.createElement(it,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[5460,2,1]]]);
//# sourceMappingURL=main.5978b42f.chunk.js.map