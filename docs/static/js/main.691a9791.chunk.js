(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{5466:function(e,t,n){e.exports=n(5642)},5634:function(e,t){},5642:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(24),i=n.n(c),o=n(28),u=n(20),s=n(70),l=n(5649),f=n(5650),d=n(5648),m=n(5),p=n(30),b=n(19),v=n(69),h=n.n(v),g=n(5647),y=Object(g.a)(function(e){return r.createElement(m.n,{button:!0,onClick:function(){return e.history.push(e.href)}},e.icon&&r.createElement(m.o,null,e.icon),r.createElement(m.q,{primary:e.text}))}),E=function(e){var t=Object(r.useState)(!1),n=Object(b.a)(t,2),c=n[0],i=n[1];return a.a.createElement("div",null,a.a.cloneElement(e.trigger,{onClick:function(){return i(!0)}}),a.a.createElement(m.h,{open:c,onClose:function(){return i(!1)}},a.a.createElement("div",{style:{width:"250px",margin:"10px"}},a.a.createElement(m.w,{variant:"h5"},"Progrssive Reader"),a.a.createElement(m.m,null,a.a.createElement(y,{icon:a.a.createElement(p.b,null),text:"Articles",href:"/"}),a.a.createElement(y,{icon:a.a.createElement(p.g,null),text:"Subscriptions",href:"/subscriptions"}),a.a.createElement(y,{icon:a.a.createElement(h.a,null),text:"Settings",href:"/settings"})))))},O=(a.a.createContext(void 0),Object(u.a)({pageActions:{flex:1,display:"flex",flexDirection:"row-reverse",width:"100%"}})),x=function(e){var t=O();return a.a.createElement(m.a,{position:"static",color:"primary"},a.a.createElement(m.v,null,a.a.createElement(E,{trigger:a.a.createElement(m.k,null,a.a.createElement(p.d,null))}),a.a.createElement(m.w,{variant:"title"},"Progrssive"),a.a.createElement("div",{className:t.pageActions,id:"app-bar-button-container"})))},j=(n(5634),Object(s.withSnackbar)(function(e){return window.snackHelper=e,null})),w=n(176),k=n(180),S=function(e){return"".concat(e.engagement?e.engagement+" ":"").concat(e.origin&&e.origin.title," / ").concat(Object(k.a)(new Date(e.published)))},A=n(7),C=n.n(A),I=n(13),T=n(46),N=[],R=T.store,F=function(){return R};window.getStore=F,Object(T.afterChange)(function(e){e.store!==e.prevStore&&(R=e.store,N.forEach(function(t){return t(e.store)}))});var M=function(){var e=Object(r.useState)(T.store),t=Object(b.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)(function(){var e=function(e){return N.push(e),e}(a);return function(){!function(e){var t=N.indexOf(e);N.splice(t,1)}(e)}}),n},L=n(37),B=n(29),U=n(178),z=n.n(U),P="https://cloud.feedly.com/v3/",W=function(e){var t={};for(var n in e||{})t[n]=e[n];return z.a.stringify(t)},q=function(){var e=Object(I.a)(C.a.mark(function e(t,n){var r,a,c,i;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=W(n),a=0===r.length?"":t.includes("?")?"&":"?",c="".concat(P).concat(t).concat(a).concat(r),e.next=5,fetch("".concat("https://cors-anywhere.herokuapp.com/").concat(c),{method:"GET"});case 5:if((i=e.sent).ok){e.next=8;break}throw i;case 8:return e.abrupt("return",i.json());case 9:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),H=function(){var e=Object(I.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q("/entries/".concat(encodeURIComponent(t)));case 2:return n=e.sent,e.abrupt("return",n[0]);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),J=n(32),_=n(58),D=n.n(_);window.localForage=D.a;var $=function(e,t){return D.a.setItem(e,JSON.stringify(t))},G=function(e){return $("".concat("entries",".").concat(e.id),e)},Q=function(e,t){return D.a.getItem(e).then(function(){var t=Object(I.a)(C.a.mark(function t(n){return C.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Set,t.next=3,X(e);case 3:return t.t1=t.sent,t.abrupt("return",new t.t0(t.t1));case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()).then(function(n){return[].concat(Object(J.a)(Object.keys(t).map(function(r){return n.add(r),$("".concat(e,".").concat(r),t[r])})),[$(e,Array.from(n))])})},V=function(){var e=Object(I.a)(C.a.mark(function e(t){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,D.a.getItem(t);case 3:return e.t1=e.sent,e.abrupt("return",e.t0.parse.call(e.t0,e.t1));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(I.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(t);case 2:return n=e.sent,e.abrupt("return",Array.isArray(n)?n:[]);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(I.a)(C.a.mark(function e(t){var n,r,a,c,i=arguments;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:20,e.next=3,X(t);case 3:r=e.sent,a=0;case 5:if(!(a<r.length)){e.next=13;break}return e.next=8,Promise.all(r.slice(a,Math.min(a+n,r.length)).map(function(e){return V("".concat(t,".").concat(e))}));case 8:c=e.sent,F()[t]=Object(B.a)({},F()[t],c.reduce(function(e,t){return Object(B.a)({},e,Object(L.a)({},t.id,t))},{}));case 10:a+=n,e.next=5;break;case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(I.a)(C.a.mark(function e(t){var n,r,a=arguments;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:void 0,e.next=3,V(t);case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=n;case 6:return r=e.t0,F()[t]=r,e.abrupt("return",r);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(I.a)(C.a.mark(function e(){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([K("entries"),K("streams"),Y("subscriptions",[])]);case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(I.a)(C.a.mark(function e(t){var n,r,a,c=arguments;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]&&c[1],!F().updating[t]){e.next=3;break}return e.abrupt("return");case 3:if(F().updating[t]=!1,e.t1=!n,!e.t1){e.next=9;break}return e.next=8,i=t,V("".concat("entries",".").concat(i));case 8:e.t1=e.sent;case 9:if(e.t0=e.t1,e.t0){e.next=14;break}return e.next=13,H(t);case 13:e.t0=e.sent;case 14:r=e.t0,(a=F()).entries=Object(B.a)({},a.entries,Object(L.a)({},t,r)),delete a.updating[t];case 18:case"end":return e.stop()}var i},e)}));return function(t){return e.apply(this,arguments)}}(),te=function(e){var t=Object(r.useState)(void 0),n=Object(b.a)(t,2),a=n[0],c=n[1];return Object(r.useEffect)(function(){c(document.getElementById("app-bar-button-container"))},[]),a?i.a.createPortal(e.children,a):null},ne=function(){var e=Object(I.a)(C.a.mark(function e(t,n){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.unread=n,e.next=3,G(t);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),re=Object(u.a)({on:{color:"white !important"},off:{color:"gray !important"}}),ae=function(e){var t=re(void 0),n=Object(r.useCallback)(function(){ne(e.entry,!e.entry.unread)},[e.entry,e.entry.unread]);return r.createElement(m.k,{className:e.entry.unread?t.on:t.off,onClick:n},r.createElement(p.f,null))},ce=function(e,t){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:200,c=0;return Object(r.useCallback)(function(){c++,setTimeout(function(){return c--},a),c>=n&&e.apply(void 0,arguments)},[].concat(Object(J.a)(t),[n,a]))}(e,t,2,arguments.length>2&&void 0!==arguments[2]?arguments[2]:200)},ie=function(e){return function(e){var t=Object(r.useState)(!1),n=Object(b.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)(void 0),o=Object(b.a)(i,2),u=o[0],s=o[1];return Object(r.useCallback)(function(t){clearTimeout(u),a||(c(!0),e.onStart&&e.onStart()),e.onScroll&&e.onScroll();var n=setTimeout(function(){c(!1),e.onEnd&&e.onEnd()},100);s(n)},[e,a,u])}({onEnd:e})},oe=n(5592),ue=Object(u.a)({root:{maxWidth:"1000px",marginLeft:"auto",marginRight:"auto"},"@global":{"article img":{width:"100%"},"article figure":{margin:0}}}),se=Object(oe.a)(function(e){var t=M(),n=ue(),a=function(){var e=Object(u.b)();return!!e&&!Object(w.unstable_useMediaQuery)(e.breakpoints.up("md")).valueOf()}(),c=Object(r.useRef)(null),i=t.entries[e.id];Object(r.useEffect)(function(){!i&&e.id&&ee(e.id)},[e.id]),function(e){var t=M().settings.markOpenedAsRead;Object(r.useEffect)(function(){e&&e.unread&&t&&ne(e,!1)},[e&&e.id,t])}(i),function(e,t){Object(r.useEffect)(function(){e&&t&&t.current&&t.current.parentElement.scrollTo(0,0)},[e&&e.id])}(i,c);var o=ce(function(n){t.settings.doubleTapToCloseArticles&&(e.history.goBack(),n.stopPropagation(),document.getSelection().removeAllRanges())},[]);if(!i)return r.createElement(m.f,null);var s=function(e){var t=e.content||e.summary;return t&&t.content}(i),l=r.createElement(r.Fragment,null,r.createElement(m.d,{title:i.title,subheader:S(i)}),s&&r.createElement(m.c,null,r.createElement(m.w,{component:"small"},r.createElement("div",{dangerouslySetInnerHTML:{__html:s}}))));return r.createElement("article",{className:n.root,ref:c,onClick:o},a?l:r.createElement(m.b,null,l),e.active&&r.createElement(r.Fragment,null,r.createElement(te,null,r.createElement(ae,{entry:i}))))}),le=n(159),fe=function(e){var t=Array.isArray(e.children)?e.children:[e.children],n=Object(r.useRef)(null),a=Object(r.useState)(e.activeIndex||0),c=Object(b.a)(a,2),i=c[0],o=c[1];Object(r.useEffect)(function(){if(!isNaN(e.activeIndex)&&i!==e.activeIndex&&n.current){if(e.activeIndex<0||n.current&&e.activeIndex>n.current.children.length)throw new Error("Index ".concat(e.activeIndex," out of range!"));var t=n.current.children[e.activeIndex];n.current.scrollTo(t.offsetLeft,0),o(e.activeIndex)}},[e.activeIndex]);var u=ie(function(){for(var t,r=n.current,a=1/0,c=0;c<r.children.length;++c){var u=r.children[c],s=Math.abs(r.scrollLeft-u.offsetLeft);s<a&&(a=s,t=c)}void 0!==t&&t!==i&&(o(t),e.onSwiped&&e.onSwiped(t))});return r.createElement("div",{style:{scrollSnapType:"x mandatory",overflowX:"scroll",display:"flex",scrollbarWidth:"none"},onScroll:u,ref:n},t.map(function(e,t){return r.createElement("div",{key:t,style:{flexShrink:0,scrollSnapAlign:"start",scrollSnapStop:"always"}},e)}))},de=function(e){return r.createElement(le.a,{path:"".concat(e.prefix,":id*"),component:function(t){var n=t.location.pathname.substr(e.prefix.length);return e.setActive(e.prefix,n),null}})},me=Object(oe.a)(function(e){var t=M(),n=Object(r.useState)(0),a=Object(b.a)(n,2),c=a[0],i=a[1],o=Object(r.useCallback)(function(n,r){t.current[n]=r;var a=e.routes.findIndex(function(e){return e.prefix===n});i(a)},[e.routes,i]);return r.createElement(r.Fragment,null,r.createElement(fe,{activeIndex:c,onSwiped:function(n){if(n!==c){var r=e.routes[n].prefix,a=t.current[r];i((n+1)%2),e.history.push("".concat(r).concat(a||""))}}},e.routes.map(function(e,n){return r.createElement("div",{style:{width:"100vw",height:"90vh",overflow:"hidden auto",paddingTop:"10px"},key:e.prefix},e.render(t.current[e.prefix],c===n))})),e.routes.map(function(e){return r.createElement(de,{key:e.prefix,prefix:e.prefix,setActive:o})}),r.createElement(le.a,{path:"/",exact:!0,component:function(){return i(1),null}}))}),pe=n(179),be=function(e,t){var n;return function(){for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];clearTimeout(n),n=setTimeout(function(){return e.apply(void 0,a)},t)}},ve={markOpenedAsRead:!0,markScrolledAsRead:!0,doubleTapToCloseArticles:!0,unreadOnly:!0,fontSize:3,darkMode:!1},he=be(function(e){window.localStorage.setItem("settings",JSON.stringify(e)),console.log("saved settings!")},1e3),ge=function(e,t){F().settings[e]=t,he(F().settings)},ye=Object(u.a)({slider:{width:"48px !important"}}),Ee=function(e){var t=ye(),n=M(),a=r.useCallback(function(e,t){var n=e.target.name;ge(n,t)},[]),c=Object(r.useCallback)(function(e,t){ge("fontSize",t)},[]);return r.createElement("div",null,r.createElement(m.m,null,r.createElement(m.n,null,r.createElement(m.q,{primary:"Read opened articles",secondary:"Marks articles as read when you open them."}),r.createElement(m.p,null,r.createElement(m.t,{checked:n.settings.markOpenedAsRead,name:"markOpenedAsRead",onChange:a}))),r.createElement(m.n,null,r.createElement(m.q,{primary:"Auto mark as read",secondary:"Marks articles as read when you scoll past them."}),r.createElement(m.p,null,r.createElement(m.t,{checked:n.settings.markScrolledAsRead,name:"markScrolledAsRead",onChange:a}))),r.createElement(m.n,null,r.createElement(m.q,{primary:"Double tap to close articles",secondary:"Whether articles can be closed by double tapping them."}),r.createElement(m.p,null,r.createElement(m.t,{checked:n.settings.doubleTapToCloseArticles,name:"doubleTapToCloseArticles",onChange:a}))),r.createElement(m.g,null),r.createElement(m.n,null,r.createElement(m.q,{primary:"Article Text Size",secondary:"Controls the size of the article text"}),r.createElement(m.p,null,r.createElement(pe.a,{className:t.slider,min:1,max:5,step:1,onChange:c,value:n.settings.fontSize})))))},Oe=Object(u.a)({paper:{cursor:"pointer",position:"relative"},card:{maxHeight:"500px"},read:{color:"#F0F0F0 !important"},unread:{},tint:{background:"#FFFFFF",opacity:.6,top:"0",left:"0",bottom:"0",right:"0",position:"absolute"}}),xe=function(e){var t,n=Oe(),r=(t=e.entry).visual&&t.visual.url,c=S(e.entry),i=function(e){return e.summary&&e.summary.content}(e.entry),o=!e.entry.unread&&e.showingUnreadOnly;return a.a.createElement(m.r,{className:n.paper},a.a.createElement(m.b,{className:n.card},a.a.createElement(m.d,{title:e.entry.title,subheader:c}),r&&a.a.createElement(m.e,{src:r,component:"img",title:"Visual"}),i&&a.a.createElement(m.c,null,a.a.createElement(m.w,{component:"small"},a.a.createElement("div",{dangerouslySetInnerHTML:{__html:i}})))),o&&a.a.createElement("div",{className:n.tint}))},je={},we=function(){var e=Object(I.a)(C.a.mark(function e(t){var n,r,a=arguments;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"contents",r=a.length>2?a[2]:void 0,e.abrupt("return",q("".concat("/streams","/").concat(n,"?streamId=").concat(t),Object(B.a)({},je,r)));case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();function ke(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return Se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Se(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a,c=!0,i=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return c=e.done,e},e:function(e){i=!0,a=e},f:function(){try{c||null==r.return||r.return()}finally{if(i)throw a}}}}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ae=function(){var e=Object(I.a)(C.a.mark(function e(){var t,n,r,a;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=F().subscriptions,n=ke(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,Ie(a);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[2,12,15,18]])}));return function(){return e.apply(this,arguments)}}(),Ce=function(e){return F().subscriptions.find(function(t){return t.id===e})},Ie=function(){var e=Object(I.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we("string"===typeof t?t:t.id);case 2:return n=e.sent,e.next=5,Te(n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Te=function(){var e=Object(I.a)(C.a.mark(function e(t){var n,r,a,c,i,o,u,s;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=F(),r={},a=n.streams[t.id]&&n.streams[t.id].items||[],c=Object(L.a)({},t.id,Object(B.a)({},t,{items:Array.from(new Set([].concat(Object(J.a)(t.items.map(function(e){return e.id})),Object(J.a)(a)))),lastFetched:Date.now()})),i=ke(t.items);try{for(i.s();!(o=i.n()).done;)u=o.value,(s=n.entries[u.id])&&(u.unread=s.unread,u.readTime=s.readTime),r[u.id]=u}catch(l){i.e(l)}finally{i.f()}return n.entries=Object(B.a)({},n.entries,r),n.streams=Object(B.a)({},F().streams,c),e.next=10,Promise.all([Q("streams",c),Q("entries",r)]);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();function Ne(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return Re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Re(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a,c=!0,i=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return c=e.done,e},e:function(e){i=!0,a=e},f:function(){try{c||null==r.return||r.return()}finally{if(i)throw a}}}}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Fe=function(){var e=Object(I.a)(C.a.mark(function e(){var t,n,r,a;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=F().subscriptions,n=Ne(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,Me(a.id);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:window.snackHelper.enqueueSnackbar("Updated subscriptions!");case 19:case"end":return e.stop()}},e,null,[[2,12,15,18]])}));return function(){return e.apply(this,arguments)}}(),Me=function(){var e=Object(I.a)(C.a.mark(function e(t){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return Fe(),e.abrupt("return");case 3:if(!F().updating.stream){e.next=5;break}return e.abrupt("return");case 5:return F().updating.stream=!0,e.prev=6,e.next=9,Ie(t);case 9:e.next=15;break;case 11:e.prev=11,e.t0=e.catch(6),console.error(t,e.t0),window.snackHelper.enqueueSnackbar("Unabled to update ".concat(Ce(t).title,". Are you offline?"));case 15:F().updating.stream=!1;case 16:case"end":return e.stop()}},e,null,[[6,11]])}));return function(t){return e.apply(this,arguments)}}(),Le=Object(u.a)({root:{display:"flex",justifyContent:"center"}}),Be=function(e){var t=Le();return r.createElement("div",{className:t.root},e.children)},Ue=function(e){var t=Object(r.useRef)(null),n=Object(r.useState)(null),a=Object(b.a)(n,2),c=a[0],i=a[1],o=Object(r.useState)(null),u=Object(b.a)(o,2),s=u[0],l=u[1],f=Object(r.useState)(!1),d=Object(b.a)(f,2),p=d[0],v=d[1];return r.useEffect(function(){if(t&&t.current){c&&s&&c.removeEventListener("scroll",s);var n=be(function(e){var n=function(e,t){if(!e||!t)return!1;var n=t.getBoundingClientRect(),r=e.getBoundingClientRect();return n.bottom<r.top}(c,t.current);n!==p&&v(n)},1e3),r=e.getContainer(t.current);return i(r),l(n),r.addEventListener("scroll",n,{passive:!0}),function(){c&&s&&c.removeEventListener("scroll",s)}}},[e.getContainer,t]),r.createElement(m.s,{rootRef:t},e.children(!p))},ze=n(181),Pe=Object(u.a)({stickyHeader:{position:"sticky",top:0}}),We=function(e){var t=Pe(),n=e.children,a=e.className,c=Object(ze.a)(e,["children","className"]);return r.createElement("div",Object.assign({className:"".concat(a," ").concat(t.stickyHeader)},c),n)},qe=Object(u.a)({root:{},loadingButton:{color:"white !important"},loader:{marginBottom:"10px"},header:{top:"-10px",zIndex:1e3,margin:"-10px -10px 10px -10px"}}),He=function(e){return Object(r.useEffect)(function(){e.entry&&e.entry.unread&&ne(e.entry,!1)},[e.entry&&e.entry.id]),null},Je=Object(oe.a)(function(e){var t=e.id,n=function(e){var t=M();if(!e)return{id:"",items:Object.values(t.entries),title:"All"};var n=t.streams;if(e.startsWith("feed/"))return{id:e,items:Object.values(t.entries).filter(function(t){return t.origin.streamId===e}),title:"Feed"};if(e.includes("/tag/"))return{id:e,items:Object.values(t.entries).filter(function(t){return t.tags&&t.tags.some(function(t){return t.id===e})}),title:"Tag"};var r=n[e];return r?Object(B.a)({},r,{items:r.items.map(function(e){return t.entries[e]})}):void 0}(t);return Object(r.useEffect)(function(){!t||n&&n.id!==t||Ae()},[t]),a.a.createElement(_e,{entries:n&&n.items,id:t,history:e.history,active:e.active})}),_e=function(e){var t,n=M(),c=qe(void 0),i=n.settings.markScrolledAsRead,o=!e.entries||(t="stream",R.updating[t||void 0]),u=Object(r.useState)({}),s=Object(b.a)(u,2),l=s[0],f=s[1],d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.entries)return[];var r=e.entries.filter(function(e){return e&&(e.unread||!n.settings.unreadOnly||t[e.id])});return r.sort(function(e,t){return t.published-e.published}),r};Object(r.useEffect)(function(){f(d().reduce(function(e,t){return e[t.id]=!0,e},{}))},[e.id,n.settings.unreadOnly]);var v=Object(r.useMemo)(function(){return d(l)},[e.entries&&e.entries.length,e.id,n.settings.unreadOnly,n.updating[e.id],l]),h=100*(1-Object(r.useMemo)(function(){return v.filter(function(e){return e.unread}).length},[e.entries])/v.length);return a.a.createElement("div",{className:c.root},n.settings.unreadOnly&&!!v.length&&a.a.createElement(We,{className:c.header},a.a.createElement(m.l,{variant:"determinate",value:h,color:"secondary"})),o&&a.a.createElement(Be,null,a.a.createElement(m.f,{className:c.loader})),a.a.createElement(m.j,{spacing:24,container:!0,justify:"center",wrap:"wrap"},v.map(function(t){return a.a.createElement(Ue,{key:t.id,getContainer:function(e){return e.parentElement.parentElement.parentElement}},function(r){return a.a.createElement(m.j,{item:!0,lg:3,md:6,sm:6,xs:12,onClick:function(){return e.history.push("/entries/".concat(t.id))}},a.a.createElement(xe,{entry:t,showingUnreadOnly:n.settings.unreadOnly}),!r&&i&&a.a.createElement(He,{entry:t}))})})),e.active&&a.a.createElement(a.a.Fragment,null,a.a.createElement(te,null,a.a.createElement(m.k,{disabled:o,onClick:function(){return Me(e.id)}},a.a.createElement(p.e,null))),a.a.createElement(te,null,a.a.createElement(m.i,{control:a.a.createElement(m.t,{checked:n.settings.unreadOnly,onClick:function(){return n.settings.unreadOnly=!n.settings.unreadOnly}}),label:"Unread"}))))},De=function(){var e=Object(I.a)(C.a.mark(function e(t,n){var r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q("".concat("/search/feeds","?query=").concat(t),n);case 2:return r=e.sent,e.abrupt("return",r.results);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),$e=n(5651),Ge=Object(u.a)({content:{padding:"8px",maxWidth:"800px",marginLeft:"auto",marginRight:"auto"},results:{paddingTop:"8px"},result:{padding:"8px"}}),Qe=function(e){var t=Ge(),n=M(),a=new Set(n.subscriptions.map(function(e){return e.id})),c=function(e){return a.has(e.id)},i=Object(r.useState)("@subscribed"),o=Object(b.a)(i,2),u=o[0],s=o[1],l=Object($e.a)(u,200),f=Object(b.a)(l,1)[0],d=Object(r.useState)([]),p=Object(b.a)(d,2),v=p[0],h=p[1];Object(r.useEffect)(function(){f?u.startsWith("@")||De(f).then(h):h([])},[f]);var g="@subscribed"==u?n.subscriptions:v,y=Object(r.useCallback)(function(){var e=Object(I.a)(C.a.mark(function e(t){var r,a;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c(t)?(r=Object(J.a)(n.subscriptions),a=r.findIndex(function(e){return e.id===t.id}),r.splice(a,1),n.subscriptions=r):n.subscriptions=[].concat(Object(J.a)(n.subscriptions),[t]),e.next=3,$("subscriptions",F().subscriptions);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[n.subscriptions]);return r.createElement("div",{className:t.content},r.createElement(m.u,{label:"Search term or feed url",variant:"filled",fullWidth:!0,value:u,onChange:function(e){return s(e.target.value)}}),r.createElement("div",{className:t.results},g.map(function(e){return r.createElement(Xe,{key:e.id,subscription:e,isSubscribed:c(e),toggleSubscription:y})})))},Ve=Object(u.a)({root:{display:"flex",alignItems:"center",marginBottom:"8px"},icon:{width:150,alignSelf:"stretch"},content:{marginLeft:"8px",flexGrow:1},controls:{marginLeft:"8px"}}),Xe=function(e){var t=Ve();return r.createElement(m.b,{className:t.root},r.createElement(m.e,{className:t.icon,image:e.subscription.visualUrl||e.subscription.iconUrl}),r.createElement("div",{className:t.content},e.subscription.title),r.createElement("div",{className:t.controls},r.createElement(m.k,{onClick:function(){return e.toggleSubscription(e.subscription)}},e.isSubscribed?r.createElement(p.c,null):r.createElement(p.a,null))))},Ke=Object(u.a)(function(e){return{root:{width:"100vw",height:"100vw"}}}),Ye=[{prefix:"/settings/",render:function(){return a.a.createElement(Ee,null)}},{prefix:"/stream/",render:function(e,t){return a.a.createElement(Je,{id:e,active:t})}},{prefix:"/entries/",render:function(e,t){return a.a.createElement(se,{id:e,active:t})}}],Ze=function(e){var t=Ke({}),n=M(),c=Object(r.useMemo)(function(){return e=n.settings,Object(o.createMuiTheme)({palette:{type:e.darkMode?"dark":"light",primary:{main:"#2BB24C"}},typography:{fontSize:8+2*e.fontSize}});var e},[n.settings.fontSize]);return a.a.createElement(l.a,null,a.a.createElement(o.MuiThemeProvider,{theme:c},a.a.createElement(s.SnackbarProvider,null,a.a.createElement(j,null),a.a.createElement("div",{className:t.root},a.a.createElement(x,null),a.a.createElement(f.a,null,a.a.createElement(d.a,{path:"/subscriptions"},a.a.createElement(Qe,null)),a.a.createElement(me,{routes:Ye}))))))},et=T.store;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));et.streams={},et.entries={},et.updating={categories:!1,stream:!1},et.settings=function(){var e=window.localStorage.getItem("settings");return e?JSON.parse(e):ve}(),et.current={},et.subscriptions=[],Z(),Ae(),i.a.render(a.a.createElement(Ze,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[5466,2,1]]]);
//# sourceMappingURL=main.691a9791.chunk.js.map