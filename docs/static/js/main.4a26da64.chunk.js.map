{"version":3,"sources":["api/common.ts","api/streams.ts","components/CollapsableListItem.tsx","CollectionView.tsx","hooks/promise.ts","hooks/store.ts","services/persister.ts","actions/profile.ts","api/markers.ts","api/collections.ts","actions/collection.ts","api/profile.ts","hooks/profile.ts","CollectionsView.tsx","hooks/collections.ts","AppDrawer.tsx","AppBar.tsx","components/SnackbarHelper.tsx","services/entry.ts","api/entry.ts","actions/entry.ts","components/AppBarButton.tsx","actions/marker.ts","MarkerButton.tsx","hooks/callbacks.ts","EntryViewer.tsx","hooks/responsive.ts","components/SwipeableView.tsx","RouteManager.tsx","services/debounce.ts","actions/settings.ts","SettingsPage.tsx","EntryCard.tsx","services/store.ts","actions/stream.ts","components/Centre.tsx","components/ScrollVisibility.tsx","components/StickyHeader.tsx","StreamViewer.tsx","hooks/stream.ts","App.tsx","theme.ts","serviceWorker.ts","index.tsx"],"names":["feedlyQueryString","params","fixedCase","key","queryString","stringify","makeRequest","_ref","Object","asyncToGenerator","regenerator_default","a","mark","_callee","url","joiner","requestUrl","response","wrap","_context","prev","next","length","includes","concat","feedlyConfig","feedlyUrl","fetch","method","headers","Authorization","accessToken","sent","ok","abrupt","json","stop","this","_x","_x2","apply","arguments","defaultOptions","unreadOnly","getStream","streamId","type","options","_args","undefined","objectSpread","getAllId","userId","getUncategorizedId","getSavedId","useStyles","makeStyles","@global",".nested-list *","paddingLeft","CollapsableListItem","props","_useState","useState","defaultOpen","_useState2","slicedToArray","open","setOpen","react","header","toggle","core_index_es","in","timeout","unmountOnExit","disablePadding","className","children","SubscriptionView","withRouter","button","onClick","history","push","feed","feedId","title","p","collection","id","icons_index_es","label","e","stopPropagation","feeds","map","s","executeOnce","execute","_len","keys","Array","_key","useEffect","updaters","currentStore","defaultStore","getStore","window","afterChange","event","store","prevStore","forEach","u","useStore","setStore","updater","addUpdater","index","indexOf","splice","removeUpdater","localForage","profilePromise","markersForOnline","save","value","setItem","JSON","saveEntry","entry","saveChildren","getItem","then","t0","Set","getChildKeys","t1","toConsumableArray","k","add","from","get","_ref2","_callee2","_context2","parse","call","_ref3","_callee3","parentKey","_context3","isArray","_x3","batchedLoad","_ref4","_callee4","storeKey","batchSize","i","results","_args4","_context4","Promise","all","slice","Math","min","reduce","defineProperty","_x4","load","_ref5","_callee5","_context5","_x5","loadStore","_ref6","_callee6","_context6","getCollections","updateCollections","shouldFetch","collections","updating","snackHelper","enqueueSnackbar","updateProfile","force","profile","loadProfile","_args2","getLoadProfilePromise","useProfile","ManualEntry","categoryId","text","CollectionsView","categories","values","useCollections","c","CollectionView","AppDrawer","react_default","createElement","React","cloneElement","trigger","onClose","style","width","margin","variant","primary","createContext","pageActions","flex","display","flexDirection","AppBar","styles","position","color","SnackbarHelper","withSnackbar","getEntryByline","engagement","origin","relativeDate","Date","published","getEntry","entryId","entries","encodeURIComponent","updateEntry","AppBarButton","appBar","setAppBar","document","getElementById","ReactDOM","createPortal","updateMarkers","marker","endpoint","Content-Type","body","hitMarkerWhenOnline","updateUnread","items","unread","action","entryIds","updateSaved","saved","_args3","saveMarkersForOnline","getMarkersForOnline","_callee8","updateMarkersForOnline","_context8","_ref8","_callee7","promises","_context7","navigator","onLine","addEventListener","setUnread","setSaved","profileId","tagId","getSavedTag","tags","filter","on","off","EntryReadButton","toggleRead","useCallback","EntrySavedButton","some","endsWith","toggleSaved","useDoubleTap","callback","change","requiredTaps","delay","taps","setTimeout","useNTap","useOnScrollEnd","handler","handlers","isScrolling","setScrolling","_useState3","_useState4","scrollTimeout","setScrollTimeout","clearTimeout","onStart","onScroll","newScrollTimeout","onEnd","useOnScroll","root","maxWidth","marginLeft","marginRight","article img","article figure","isPhone","theme","useTheme","unstable_useMediaQuery","breakpoints","up","valueOf","useIsPhone","domElement","useRef","shouldMarkAsRead","settings","markOpenedAsRead","maybeMarkAsRead","ref","current","parentElement","scrollTo","scrollToTop","doubleTap","doubleTapToCloseArticles","goBack","getSelection","removeAllRanges","content","detail","summary","getEntryContent","article","subheader","component","dangerouslySetInnerHTML","__html","active","MarkerButton_EntryReadButton","MarkerButton_EntrySavedButton","SwipeableView","swipeableView","activeIndex","setActiveIndex","isNaN","Error","child","offsetLeft","selectedChild","element","closestDistance","Infinity","distance","abs","scrollLeft","onSwiped","scrollSnapType","overflowX","scrollbarWidth","flexShrink","scrollSnapAlign","scrollSnapStop","RouteSetter","Route","path","prefix","location","pathname","substr","setActive","activeSlide","setActiveSlide","slideIndex","routes","findIndex","r","SwipeableView_SwipeableView","n","height","overflow","paddingTop","render","RouteManager_RouteSetter","exact","debounce","f","time","args","defaultSettings","markScrolledAsRead","fontSize","darkMode","debouncedSaveSettings","localStorage","console","log","updateSettings","name","slider","SettingsPage","onSwitchChange","setting","target","onFontSizeChange","secondary","checked","onChange","lab_index_es","max","step","paper","cursor","card","maxHeight","read","tint","background","opacity","top","left","bottom","right","EntryCard","visualUrl","visual","getEntrySummary","tintGray","showingUnreadOnly","src","ensureStream","lastFetched","updateWithStream","stream","allId","savedId","uncategorizedId","newStreams","_arr2","_i2","oldStream","newEntries","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_iterator3","_step3","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_iterator4","_step4","category","_arr3","_i3","_category2","streams","Symbol","iterator","done","return","finish","updateStreams","thenSync","getAllUnread","continuation","justifyContent","Centre","ScrollVisibility","elementRef","scrollContainer","setScrollContainer","scrollHandler","setScrollHandler","_useState5","_useState6","above","setAbove","removeEventListener","debounced","newAbove","container","elementRect","getBoundingClientRect","containerRect","isAbove","getContainer","passive","rootRef","stickyHeader","StickyHeader","rest","objectWithoutProperties","assign","loadingButton","loader","marginBottom","zIndex","MarkEntryAsRead","startsWith","t","useStream","StreamViewer_EntriesViewer","EntriesViewer","loading","entryIdsToKeep","setEntryIdsToKeep","getSuitableEntries","keep","sort","b","suitableEntries","useMemo","readProgress","spacing","justify","ScrollVisibility_ScrollVisibility","visible","item","lg","md","sm","xs","StreamViewer_MarkEntryAsRead","Fragment","disabled","control","StreamViewer","EntryViewer","App","createMuiTheme","palette","main","typography","BrowserRouter","core_styles","build","RouteManager","Boolean","hostname","match","loadSettings","src_App","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.4a26da64.chunk.js","sourcesContent":["import queryString from \"querystring\";\nimport feedlyConfig from '../feedly.json';\n\nconst bypassCorsUrl = 'https://cors-anywhere.herokuapp.com/';\n\nexport const feedlyQueryString = (params: Object): string => {\n    const fixedCase = {};\n    for (const key in params || {}) {\n        fixedCase[key] = params[key];\n    }\n\n    return queryString.stringify(fixedCase);\n}\n\nexport const makeRequest = async <T>(url: string, params?: Object): Promise<T> => {\n    const queryString = feedlyQueryString(params);\n    const joiner = queryString.length === 0\n        ? ''\n        : url.includes('?')\n            ? '&'\n            : '?';\n\n    const requestUrl = `${feedlyConfig.feedlyUrl}${url}${joiner}${queryString}`;\n\n    // TODO: Use a custom cors proxy, this should not be in production.\n    const response = await fetch(`${bypassCorsUrl}${requestUrl}`, {\n        method: 'GET',\n        headers: {\n            'Authorization': `OAuth ${feedlyConfig.accessToken}`\n        }\n    });\n\n    // Make sure error handling is triggered if the response status is not ok.\n    if (!response.ok)\n        throw response;\n\n    return response.json();\n}\n\nexport const makePostRequest = (endpoint: string, params: Object) => {\n    return fetch(`${bypassCorsUrl}${feedlyConfig.feedlyUrl}${endpoint}`, {\n        method: 'POST',\n        headers: {\n            'Authorization': `OAuth ${feedlyConfig.accessToken}`,\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(params)\n    });\n}","import { Stream } from '../model/stream';\nimport { makeRequest } from './common';\nconst endpoint = '/streams'\n\nexport interface StreamRequestOptions {\n    count?: number;\n    ranked?: 'oldest' | 'newest';\n    unreadOnly?: boolean;\n    newerThan?: number;\n    continuation?: string;\n}\n\nconst defaultOptions = {\n    unreadOnly: true,\n}\n\nexport const getStream = async (streamId: string, type: 'contents' | 'id' = 'contents', options?: StreamRequestOptions): Promise<Stream> => {\n    return makeRequest<Stream>(`${endpoint}/${type}?streamId=${streamId}`, { ...defaultOptions, ...options });\n}\n\nexport const getAllStreams = async (userId: string, unreadOnly: boolean = true): Promise<Stream> => {\n    return getStream(getAllId(userId), 'contents', { unreadOnly });\n}\n\nexport const getAllId = (userId: string) => `user/${userId}/category/global.all`;\n\nexport const getUncategorizedId = (userId: string) => {\n    return `user/${userId}/category/global.uncategorized`;\n}\n\nexport const getSavedId = (userId: string) => `user/${userId}/tag/global.saved`;","import { Collapse, List, ListItem } from '@material-ui/core';\nimport * as React from 'react';\nimport { useState } from 'react';\nimport { makeStyles } from '@material-ui/styles';\n\nconst useStyles = makeStyles(({\n    \"@global\": {\n        \".nested-list *\": {\n            paddingLeft: '40px'\n        }\n    }\n}));\n\ninterface Props {\n    defaultOpen?: boolean;\n    children?: React.ReactNode[] | React.ReactNode;\n    header: (props: { open: boolean, toggle: () => void }) => JSX.Element;\n}\n\nexport default (props: Props) => {\n    useStyles();\n\n    const [open, setOpen] = useState(props.defaultOpen);\n    return <>\n        {props.header({ open, toggle: () => setOpen(!open) })}\n        <Collapse in={open} timeout=\"auto\" unmountOnExit>\n            <List disablePadding className=\"nested-list\">\n                {props.children}\n            </List>\n        </Collapse>\n    </>;\n}","import { ExpansionPanel, ExpansionPanelDetails, ExpansionPanelSummary, ListItem, ListItemText, ListItemIcon } from '@material-ui/core';\nimport { ExpandMore, RssFeed, ExpandLess } from '@material-ui/icons';\nimport * as React from 'react';\nimport CollapsableListItem from './components/CollapsableListItem';\nimport { Subscription } from './model/subscription';\nimport { withRouter, RouteComponentProps } from 'react-router';\nimport { Collection, Feed } from './model/collection';\n\ninterface Props extends RouteComponentProps<{}> {\n    collection: Collection;\n}\n\n\nconst SubscriptionView = withRouter((props: { feed: Feed } & RouteComponentProps<any>) => {\n\n    return <ListItem button onClick={() => props.history.push(`/stream/${props.feed.feedId}`)}>\n        <ListItemText>\n            {props.feed.title}\n        </ListItemText>\n    </ListItem>\n})\n\nexport default withRouter((props: Props) => {\n    return <CollapsableListItem\n        defaultOpen={true}\n        header={p => <ListItem button onClick={() => props.history.push(`/stream/${props.collection.id}`)}>\n            <ListItemIcon>\n                <RssFeed />\n            </ListItemIcon>\n            <ListItemText>{props.collection.label}</ListItemText>\n            <div onClick={e => {\n                p.toggle();\n                e.stopPropagation();\n            }}>\n                {p.open ? <ExpandLess /> : <ExpandMore />}\n            </div>\n        </ListItem>}>\n        {props.collection.feeds.map(s => <SubscriptionView key={s.id} feed={s} />)}\n    </CollapsableListItem>\n})","import { useEffect, useState } from \"react\";\nimport { useForeUpdate } from \"./effects\";\n\nexport const useResult = <T>(promise: Promise<T>) => {\n    const [result, setResult] = useState(undefined);\n\n    useEffect(() => {\n        if (result) return;\n        \n        promise.then(setResult);\n    });\n\n    return result;\n}\n\nexport const executeOnce = <T>(execute: (...args) => Promise<T>, ...keys) => {\n    useEffect(() => {\n        execute(...keys);\n    }, [...keys]);\n}\n\ninterface Cache<T> {\n    updating: boolean;\n    lastArgs: any[];\n    state: T;\n}\n\nconst elementsChanged = (l1: any[], l2: any[]) => l1.length !== l2.length || l1.some((item, index) => l2[index] !== item);\nexport const makeUpdatableSharedCache = <T>(fetcher: (...args) => Promise<T>, initialValue?: T) => {\n    const cache: Cache<T> = {\n        updating: false,\n        lastArgs: [],\n        state: initialValue\n    };\n\n    const updaters: (() => void)[] = [];\n    const update = async (...args) => {\n        if (cache.updating) return;\n\n        const result = await fetcher(...args);\n        cache.state = result;\n        updaters.forEach(u => u());\n\n        cache.lastArgs = args;\n        cache.updating = false;\n    };\n\n    return (...args): T => {\n        // If we don't have any data, or our args have changed\n        if (!cache.state\n            || elementsChanged(args, cache.lastArgs)) {\n            update(...args)\n        }\n\n        // Manage registering for update\n        const forceUpdate = useForeUpdate();\n        useEffect(() => {\n            updaters.push(forceUpdate);\n            return () => {\n                const index = updaters.indexOf(forceUpdate);\n                updaters.splice(index, 1);\n            };\n        })\n\n        return cache.state;\n    };\n\n}","import { useEffect, useState } from 'react';\nimport { afterChange, store as defaultStore, Store } from 'react-recollect';\nimport { makeUpdatableSharedCache } from './promise';\n\ntype Updater = (store: Store) => void;\n\nconst updaters: Updater[] = [];\nconst addUpdater = (updater: Updater) => {\n    updaters.push(updater);\n    return updater;\n}\n\nconst removeUpdater = (updater: Updater) => {\n    const index = updaters.indexOf(updater);\n    updaters.splice(index, 1);\n}\n\nlet currentStore = defaultStore;\nexport const getStore = () => currentStore;\n(window as any).getStore = getStore;\n\nafterChange(event => {\n    if (event.store === event.prevStore)\n      return;\n\n    currentStore = event.store;\n    updaters.forEach(u => u(event.store));\n});\n\nexport const useStore = () => {\n    const [store, setStore] = useState(defaultStore);\n\n    useEffect(() => {\n        const updater = addUpdater(setStore);\n        return () => {\n            removeUpdater(updater);\n        };\n    });\n\n    return store;\n}\n\nexport const makeStoreCache = <T>(fetcher: (store: Store) => T | Promise<T>, onFetched: (store: Store, value: T) => void) => {\n    const storeFetcher = async () => {\n        const result = await fetcher(currentStore);\n        onFetched(currentStore, result);\n        return result;\n    };\n\n    const useCache = makeUpdatableSharedCache(storeFetcher);\n    return (lastUpdate?: number) => {\n        const cached = useCache(lastUpdate);\n        return cached;\n    }\n}\n\nexport const isUpdating = (id: string) => currentStore.updating[id];","import localForage from 'localforage';\nimport { Store } from 'react-recollect';\nimport { getStore } from '../hooks/store';\nimport { Entry } from '../model/entry';\n\n(window as any)['localForage'] = localForage;\n\nexport const entriesPrefix: keyof Store = 'entries';\n\nexport const save = (key: string, value: object) => {\n    return localForage.setItem(key, JSON.stringify(value));\n}\n\nexport const saveEntry = (entry: Entry) => {\n    return save(`${entriesPrefix}.${entry.id}`, entry);\n}\n\nexport const saveChildren = (key: string, value: object) => {\n    return localForage.getItem<string[]>(key)\n        .then(async keys => new Set(await getChildKeys(key)))\n        .then(keys => [\n            ...Object.keys(value).map(k => {\n                keys.add(k);\n                return save(`${key}.${k}`, value[k])\n            }),\n            save(key, Array.from(keys))\n        ]);\n};\n\nexport const get = async (key: string) => JSON.parse(await localForage.getItem(key));\n\nconst getChildKeys = async (parentKey: string) => {\n    const keys = await get(parentKey);\n    return Array.isArray(keys) ? keys : [];\n};\n\nconst batchedLoad = async (storeKey: keyof Store, batchSize = 20) => {\n    const keys = await getChildKeys(storeKey);\n    for (let i = 0; i < keys.length; i += batchSize) {\n        const results = await Promise.all(keys.slice(i, Math.min(i + batchSize, keys.length))\n            .map(key => get(`${storeKey}.${key}`)));\n        getStore()[storeKey] = {\n            ...getStore()[storeKey],\n            ...results.reduce((prev, next) => ({ ...prev, [(next as any).id]: next }), {})\n        };\n    }\n}\n\nexport const load = async (storeKey: keyof Store) => {\n    const value = await get(storeKey);\n    getStore[storeKey] = value;\n    return value;\n}\n\nexport const loadEntry = (id: string): Promise<Entry> => get(`${entriesPrefix}.${id}`) as Promise<Entry>;\n\nexport const loadStore = async () => {\n    await Promise.all([\n        batchedLoad('entries'),\n        batchedLoad('streams')\n    ]);\n}","import { Store } from \"react-recollect\";\nimport { getProfile } from \"../api/profile\";\nimport { getStore } from \"../hooks/store\";\nimport { save, load } from \"../services/persister\";\nimport { Profile } from \"../model/profile\";\n\nlet profilePromise: Promise<Profile>;\n\nexport const updateProfile = async (force: boolean = false) => {\n    if (getStore().updating.profile) return;\n\n    profilePromise = loadProfile(force);\n\n    getStore().updating.profile = true;\n    getStore().profile = await profilePromise;\n    getStore().updating.profile = false;\n}\n\nexport const loadProfile = async (force: boolean = false) => {\n    if (!force && profilePromise)\n      return profilePromise;\n\n    profilePromise = getLoadProfilePromise(force);\n    return profilePromise;\n}\n\nconst getLoadProfilePromise = async (force: boolean) => {\n    let profile: Profile;\n    // If we aren't forcing the load, try and load the profile from disk.\n    if (!force)\n         profile = await load('profile');\n\n    // If the load failed, load the profile from the network and save to disk.\n    if (!profile) {\n        profile = await getProfile();\n        await save('profile', profile);\n    }\n\n    return profile;\n}","import { Marker } from \"../model/markers\";\nimport { makePostRequest } from \"./common\";\nimport { Entry } from \"../model/entry\";\nimport { get, save } from \"../services/persister\";\n\nconst endpoint = '/markers';\n\nexport const updateMarkers = async (marker: Marker) => {\n    try {\n        await makePostRequest(endpoint, marker);\n    } catch (error) {\n        await hitMarkerWhenOnline(marker);\n    }\n}\n\nexport const updateUnread = async (items: (Entry | Entry[]), unread: boolean = true) => {\n    items = Array.isArray(items) ? items : [items];\n\n    const marker: Marker = {\n        type: 'entries',\n        action: unread ? 'keepUnread' : 'markAsRead',\n        entryIds: items.map(i => i.id)\n    };\n    await updateMarkers(marker);\n};\n\nexport const updateSaved = async (entry: Entry, saved: boolean = true) => {\n    const marker: Marker = {\n        type: 'entries',\n        action: saved ? 'markAsSaved' : 'markAsUnsaved',\n        entryIds: [entry.id]\n    };\n    await updateMarkers(marker);\n}\n\n\nconst markerKeysName = 'markers-for-online';\nlet markersForOnline: Marker[];\n\nconst saveMarkersForOnline = async () => {\n    await save(markerKeysName, markersForOnline);\n}\n\nexport const hitMarkerWhenOnline = async (marker: Marker) => {\n    if (!markersForOnline)\n        markersForOnline = await getMarkersForOnline();\n\n    markersForOnline.push(marker);\n    await saveMarkersForOnline();\n}\n\nexport const getMarkersForOnline = async () => {\n    return await get(markerKeysName) as any || [];\n}\n\n(async () => {\n    const updateMarkersForOnline =  async () => {\n        const promises = markersForOnline.map(updateMarkers);\n        markersForOnline.length = 0;\n        await saveMarkersForOnline();\n        await Promise.all(promises);\n    };\n\n    markersForOnline = await getMarkersForOnline();\n    if (navigator.onLine)\n      await updateMarkersForOnline();\n\n    window.addEventListener('online', updateMarkersForOnline);\n})();","import { Collection } from \"../model/collection\";\nimport { makeRequest } from \"./common\";\n\nconst endpoint = '/collections';\n\nexport const getCollections = async (): Promise<Collection[]> => {\n    return makeRequest<Collection[]>(`${endpoint}/`);\n}","import { getStore } from \"../hooks/store\";\nimport { updateProfile } from \"./profile\";\nimport { getEntry } from \"../api/entry\";\nimport { load, save } from \"../services/persister\";\nimport { getCollections } from \"../api/collections\";\n\nconst updatingName = 'collections';\nexport const updateCollections = async () => {\n    if (getStore().updating[updatingName]) return;\n\n    getStore().updating[updatingName] = true;\n\n    // Only fetch once per session.\n    const shouldFetch = !getStore().collections;\n\n    let collections = await load('collections');\n    if (collections)\n        getStore().collections = collections;\n\n    // Update from network.\n    if (shouldFetch) {\n        try {\n            collections = await getCollections();\n            getStore().collections = collections;\n\n            await save('collections', collections)\n        } catch {\n            window.snackHelper.enqueueSnackbar('Unable to fetch collections. You appear to be offline.');\n            getStore().collections = [];\n        }\n    }\n\n    delete getStore().updating[updatingName];\n}","import { makeRequest } from './common';\nimport { Profile } from '../model/profile';\nconst profileUrl = '/profile';\n\nexport const getProfile = () => {\n    return makeRequest<Profile>(profileUrl);\n}","import { Profile } from \"../model/profile\";\nimport { useStore, makeStoreCache } from \"./store\";\nimport { executeOnce } from \"./promise\";\nimport { getProfile } from \"../api/profile\";\nimport { useEffect } from \"react\";\nimport { updateProfile } from \"../actions/profile\";\n\nexport const useProfile = (): Profile => {\n    const store = useStore();\n\n    useEffect(() => {\n        if (store.profile) return;\n        updateProfile();\n    }, []);\n\n    return store.profile;\n}","import * as React from 'react';\nimport CollectionView from './CollectionView';\nimport { useCollections } from './hooks/collections';\nimport { ListItem, ListItemText, ListItemIcon } from '@material-ui/core';\nimport { RssFeed } from '@material-ui/icons';\nimport { withRouter, RouteComponentProps } from 'react-router';\nimport { useProfile } from './hooks/profile';\nimport { getAllId, getSavedId } from './api/streams';\nimport { useStore } from './hooks/store';\n\nconst ManualEntry = withRouter((props: RouteComponentProps & { text: string, categoryId: string }) => {\n    return <ListItem onClick={() => props.history.push(`/stream/${props.categoryId}`)} button>\n        <ListItemIcon>\n            <RssFeed />\n        </ListItemIcon>\n        <ListItemText>{props.text}</ListItemText>\n    </ListItem>;\n});\n\nexport default (props) => {\n    const profile = useProfile();\n    const categories = useCollections();\n\n    return <>\n        <ManualEntry text=\"All\" categoryId={getAllId(profile && profile.id)} />\n        <ManualEntry text=\"Saved\" categoryId={getSavedId(profile && profile.id)} />\n        {categories.map(c => <CollectionView collection={c} key={c.id} />)}\n    </>;\n}","import { useEffect, useState } from \"react\";\nimport { getSubscriptions } from \"../api/subscription\";\nimport { Category } from \"../model/category\";\nimport { Subscription } from \"../model/subscription\";\nimport { useStore } from \"./store\";\nimport { executeOnce } from \"./promise\";\nimport { Collection } from \"../model/collection\";\nimport { getCollections } from \"../api/collections\";\nimport { updateCollections } from \"../actions/collection\";\n\nexport const useCollections = (): Collection[] => {\n    const store = useStore();\n\n    // If we haven't cached the collections, get them from the internet.\n    executeOnce(updateCollections);\n\n    return store.collections\n        ? Object.values(store.collections)\n        : [];\n}","import { Drawer, List, ListItem, ListItemIcon, ListItemText, Typography } from \"@material-ui/core\";\nimport { Person } from '@material-ui/icons';\nimport React, { useState } from 'react';\nimport CategoriesView from \"./CollectionsView\";\n\nexport default (props: { trigger: JSX.Element }) => {\n    const [open, setOpen] = useState(false);\n\n    return <div>\n        {React.cloneElement(props.trigger, { onClick: () => setOpen(true) })}\n        <Drawer open={open} onClose={() => setOpen(false)}>\n            <div style={{ width: '250px', margin: '10px' }}>\n                <Typography variant='h5'>\n                    Progrssive Reader\n                </Typography>\n                <List>\n                    <ListItem button>\n                        <ListItemIcon>\n                            <Person />\n                        </ListItemIcon>\n                        <ListItemText primary=\"Login\" />\n                    </ListItem>\n                </List>\n                <CategoriesView/>\n            </div>\n        </Drawer>\n    </div>;\n}","import React, { useState, useEffect } from 'react';\nimport { Toolbar, AppBar, IconButton, Typography } from '@material-ui/core';\nimport { Menu } from '@material-ui/icons';\nimport AppDrawer from './AppDrawer';\nimport { makeStyles } from '@material-ui/styles';\n\nexport const AppBarContext: React.Context<React.Ref<any>> = React.createContext(undefined);\n\nconst useStyles = makeStyles({\n    pageActions: {\n        flex: 1,\n        display: 'flex',\n        flexDirection: 'row-reverse',\n        width: '100%'\n    }\n})\n\nexport default (props) => {\n    const styles = useStyles();\n\n    return <AppBar position=\"static\" color=\"primary\">\n            <Toolbar>\n                <AppDrawer trigger={\n                    <IconButton>\n                        <Menu />\n                    </IconButton>} />\n                <Typography variant=\"title\">Progrssive</Typography>\n                <div className={styles.pageActions} id=\"app-bar-button-container\">\n\n                </div>\n            </Toolbar>\n        </AppBar>;\n}","import { withSnackbar } from \"notistack\";\nimport * as React from 'react';\nimport \"../types/Window\";\n\nexport const SnackbarHelper = withSnackbar((props) => {\n    window.snackHelper = props;\n    return null;\n});","import { Entry } from \"../model/entry\";\nimport relativeDate from 'tiny-relative-date';\nimport { getSavedId } from \"../api/streams\";\n\nexport const getEntryContent = (entry: Entry) => {\n    const detail = entry.content || entry.summary;\n    return detail && detail.content;\n}\n\nexport const getEntrySummary = (entry: Entry) => entry.summary && entry.summary.content;\n\nexport const getEntryByline = (entry: Entry) => `${entry.engagement ? entry.engagement + ' ' : ''}${entry.origin && entry.origin.title} / ${relativeDate(new Date(entry.published))}`;\n\nexport const getEntryVisualUrl = (entry: Entry) => entry.visual && entry.visual.url;\n\nexport const isSaved = (entry: Entry) => entry.tags && entry.tags.some(e => e.id.endsWith('global.saved'));","import { makeRequest } from \"./common\";\nimport { Entry } from \"../model/entry\";\n\nexport const getEntry = async (entryId: string) => {\n    const entries = await makeRequest<Entry[]>(`/entries/${encodeURIComponent(entryId)}`);\n    return entries[0];\n}","import { getStore } from \"../hooks/store\";\nimport { getEntry } from \"../api/entry\";\nimport { loadEntry } from \"../services/persister\";\n\nexport const updateEntry = async (entryId: string, force: boolean = false) => {\n    if (getStore().updating[entryId]) return;\n    getStore().updating[entryId] = false;\n\n    // If we aren't forcing network, try and load the entry from disk.\n    // Fallback to fetching from the network.\n    const entry = (!force && await loadEntry(entryId))\n        || await getEntry(entryId);\n        \n    const store = getStore();\n    store.entries = {\n        ...store.entries,\n        [entryId]: entry\n    };\n\n    delete store.updating[entryId];\n}","import ReactDOM from \"react-dom\";\nimport React, { useState, useEffect } from 'react';\n\nexport default (props: { children: React.ReactNode }) => {\n    const [appBar, setAppBar] = useState(undefined);\n\n    useEffect(() => {\n        setAppBar(document.getElementById('app-bar-button-container'));\n    }, []);\n\n    if (!appBar) return null;\n    \n    return ReactDOM.createPortal(props.children, appBar);\n}","import { Entry } from \"../model/entry\";\nimport { updateUnread, updateSaved } from \"../api/markers\";\nimport { getSavedId as getSavedTag } from \"../api/streams\";\nimport { saveEntry } from \"../services/persister\";\n\nexport const setUnread = async (entry: Entry, unread: boolean) => {\n    entry.unread = unread;\n    await updateUnread(entry, entry.unread);\n    await saveEntry(entry);\n}\n\nexport const setSaved = async (entry: Entry, saved: boolean, profileId: string) => {\n    const tagId = getSavedTag(profileId);\n    if (!saved) {\n        entry.tags = entry.tags.filter(e => e.id !== tagId);\n    } else {\n        entry.tags = [...(entry.tags || []), {\n            id: tagId,\n            label: 'Saved For Later'\n        }];\n    }\n\n    await updateSaved(entry, saved);\n    await saveEntry(entry);\n}","import * as React from 'react';\nimport { Button, IconButton } from '@material-ui/core';\nimport { Entry } from './model/entry';\nimport { RemoveRedEye, RemoveCircleOutline, StarSharp, StarOutlined, StarBorderOutlined, Star } from '@material-ui/icons';\nimport { makeStyles } from '@material-ui/styles';\nimport { useCallback } from 'react';\nimport { isSaved } from './services/entry';\nimport { useProfile } from './hooks/profile';\nimport { setUnread, setSaved } from './actions/marker';\n\nconst useStyles = makeStyles({\n    on: {\n        color: 'white !important'\n    },\n    off: {\n        color: 'gray !important'\n    }\n})\n\ninterface MarkerButtonProps {\n    entry: Entry;\n}\n\nexport const EntryReadButton = (props: MarkerButtonProps) => {\n    const styles = useStyles();\n    const toggleRead = useCallback(() => {\n        setUnread(props.entry, !props.entry.unread);\n    }, [props.entry, props.entry.unread]);\n\n    return <IconButton\n        className={props.entry.unread ? styles.on : styles.off}\n        onClick={toggleRead}>\n        <RemoveRedEye/>\n    </IconButton>;\n}\n\nexport const EntrySavedButton = (props: MarkerButtonProps) => {\n    const styles = useStyles();\n    const profile = useProfile();\n    const saved = isSaved(props.entry);\n    \n    const toggleSaved = useCallback(() => {\n        setSaved(props.entry, !saved, profile.id);\n    }, [props.entry, saved]);\n    return <IconButton className={styles.on}\n        onClick={toggleSaved}>\n        {saved\n            ? <Star/>\n            : <StarBorderOutlined/>}\n    </IconButton>\n}","import * as React from 'react';\nimport { useCallback, useState } from 'react';\n\nexport const useNTap = <Type>(callback: (...args) => void, change: [], requiredTaps = 2, delay = 200) => {\n    // Should be fine here. If we rerender a double tap should be cancelled anyway.\n    let taps = 0;\n    const memoized = useCallback((...args) => {\n        // Increment number of taps\n        taps++;\n        // After timeout, we don't care about this tap.\n        setTimeout(() => taps--, delay);\n\n        // If we've tapped enough times, fire the callback.\n        if (taps >= requiredTaps) callback(...args);\n    }, [...change, requiredTaps, delay]);\n\n    return memoized;\n}\n\nexport const useDoubleTap = (callback: (...args) => void, change: [], delay = 200) => useNTap(callback, change, 2, delay);\n\ninterface ScrollEvents {\n    onStart?: () => void;\n    onEnd?: () => void;\n    onScroll?: () => void;\n}\n\nexport const useOnScroll = (handlers: ScrollEvents) => {\n    const [isScrolling, setScrolling ] = useState(false);\n    const [scrollTimeout, setScrollTimeout] = useState(undefined);\n\n    const memoized = useCallback((e) => {\n        // Reset timeout.\n        clearTimeout(scrollTimeout);\n\n        if (!isScrolling) {\n            setScrolling(true);\n            handlers.onStart && handlers.onStart();\n        }\n\n        handlers.onScroll && handlers.onScroll();\n\n        const newScrollTimeout = setTimeout(() => {\n            setScrolling(false);\n            handlers.onEnd && handlers.onEnd();\n        }, 100);\n        setScrollTimeout(newScrollTimeout);\n    }, [handlers, isScrolling, scrollTimeout]);\n\n    return memoized;\n};\n\nexport const useOnScrollEnd = (handler: () => void) => {\n    return useOnScroll({ onEnd: handler });\n};","import { Card, CardContent, CardHeader, CircularProgress, Typography, Fab } from \"@material-ui/core\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport * as React from 'react';\nimport { useEffect, useRef } from 'react';\nimport { useIsPhone } from \"./hooks/responsive\";\nimport { useEntry } from \"./hooks/stream\";\nimport { getEntryByline, getEntryContent } from \"./services/entry\";\nimport { getStore, useStore } from \"./hooks/store\";\nimport { updateEntry } from \"./actions/entry\";\nimport AppBarButton from \"./components/AppBarButton\";\nimport { EntryReadButton, EntrySavedButton } from \"./MarkerButton\";\nimport { Add } from \"@material-ui/icons\";\nimport { Entry } from \"./model/entry\";\nimport { setUnread } from \"./actions/marker\";\nimport { useDoubleTap } from \"./hooks/callbacks\";\nimport { withRouter, RouteComponentProps } from \"react-router\";\n\nconst useStyles = makeStyles({\n    root: {\n        maxWidth: '1000px',\n        marginLeft: 'auto',\n        marginRight: 'auto',\n    },\n    '@global': {\n        'article img': {\n            width: '100%'\n        },\n        'article figure': {\n            margin: 0\n        }\n    }\n});\n\nconst maybeMarkAsRead = (entry: Entry) => {\n    const store = useStore();\n    const shouldMarkAsRead = store.settings.markOpenedAsRead;\n\n    useEffect(() => {\n        if (!entry || !entry.unread || !shouldMarkAsRead) return;\n\n        setUnread(entry, false);\n    }, [entry && entry.id, shouldMarkAsRead]);\n}\n\nconst scrollToTop = (entry: Entry, ref: React.MutableRefObject<any>) => {\n    useEffect(() => {\n        if (!entry || !ref || !ref.current) return;\n\n        ref.current.parentElement.scrollTo(0, 0);\n    }, [entry && entry.id]);\n}\n\ninterface Props extends RouteComponentProps<{}> {\n    id: string,\n    active: boolean\n}\n\nexport default withRouter((props: Props) => {\n    const store = useStore();\n\n    const styles = useStyles();\n    const isPhone = useIsPhone();\n    const domElement = useRef(null);\n\n    const entry = store.entries[props.id];\n\n    useEffect(() => {\n        if (entry || !props.id) return;\n        updateEntry(props.id);\n    }, [props.id]);\n\n    maybeMarkAsRead(entry);\n    scrollToTop(entry, domElement);\n\n    const doubleTap = useDoubleTap((event) => {\n        if (!store.settings.doubleTapToCloseArticles)\n            return;\n\n        props.history.goBack();\n        event.stopPropagation();\n        // Clear potential accidental selection.\n        document.getSelection().removeAllRanges();\n    }, []);\n\n    if (!entry)\n        return <CircularProgress />;\n\n    const content = getEntryContent(entry);\n\n    const article = <>\n        <CardHeader\n            title={entry.title}\n            subheader={getEntryByline(entry)} />\n        {content && <CardContent>\n            <Typography component='small'>\n                <div dangerouslySetInnerHTML={{ __html: content }}></div>\n            </Typography>\n        </CardContent>}\n    </>;\n\n    return <article className={styles.root} ref={domElement} onClick={doubleTap}>\n        {isPhone\n            ? article\n            : <Card>{article}</Card>}\n        {props.active && <>\n            <AppBarButton>\n                <EntryReadButton entry={entry} />\n            </AppBarButton>\n            <AppBarButton>\n                <EntrySavedButton entry={entry} />\n            </AppBarButton>\n        </>}\n    </article>;\n});","import { Theme } from \"@material-ui/core\";\nimport { unstable_useMediaQuery } from \"@material-ui/core/useMediaQuery\";\nimport { useTheme } from \"@material-ui/styles\";\n\nexport const useIsPhone = () => {\n    const theme = useTheme() as Theme;\n    if (!theme) return false;\n    const query = unstable_useMediaQuery(theme.breakpoints.up('md'));\n\n    return !query.valueOf();\n}","import * as React from 'react'\nimport { useEffect, useCallback, useRef, useState } from 'react';\nimport { useOnScrollEnd } from '../hooks/callbacks';\n\ninterface Props {\n    children: React.ReactNode[] | React.ReactNode;\n\n    onSwiped?: (selectedIndex: number) => void;\n    activeIndex?: number;\n}\n\nexport const SwipeableView = (props: Props) => {\n    const children = Array.isArray(props.children) ? props.children : [props.children];\n    \n    const swipeableView = useRef(null);\n    const [activeIndex, setActiveIndex] = useState(props.activeIndex || 0);\n    \n    // Update active index based on props.activeIndex.\n    useEffect(() => {\n        if (isNaN(props.activeIndex) || activeIndex === props.activeIndex)\n          return;\n\n        if (!swipeableView.current)\n          return;\n\n        if (props.activeIndex < 0 || swipeableView.current && props.activeIndex > swipeableView.current.children.length)\n          throw new Error(`Index ${props.activeIndex} out of range!`);\n\n        const child = swipeableView.current.children[props.activeIndex];\n        swipeableView.current.scrollTo(child.offsetLeft, 0);\n\n        setActiveIndex(props.activeIndex);\n    }, [props.activeIndex])\n\n    const onScroll = useOnScrollEnd(() => {\n        const element = swipeableView.current;\n\n        let selectedChild;\n        let closestDistance = Infinity;\n\n        for (let i = 0; i < element.children.length; ++i) {\n            const child: any = element.children[i];\n            const distance = Math.abs(element.scrollLeft - child.offsetLeft);\n            if (distance < closestDistance) {\n                closestDistance = distance;\n                selectedChild = i;\n            }\n        }\n\n        if (selectedChild !== undefined && selectedChild !== activeIndex) {\n            setActiveIndex(selectedChild);\n            props.onSwiped && props.onSwiped(selectedChild);\n        }\n    });\n\n    return <div style={{\n        scrollSnapType: 'x mandatory',\n        overflowX: 'scroll',\n        display: 'flex',\n        scrollbarWidth: 'none',\n    }}\n        onScroll={onScroll}\n        ref={swipeableView}>\n        {children.map((c, i) => <div key={i} style={{\n            flexShrink: 0,\n            scrollSnapAlign: 'start',\n            scrollSnapStop: 'always'\n        } as any}>\n            {c}\n        </div>)}\n    </div>\n}","import * as React from 'react';\nimport { useCallback, useState } from 'react';\nimport { Route, RouteComponentProps, withRouter, Switch } from 'react-router';\nimport { SwipeableView } from './components/SwipeableView';\nimport { useStore } from './hooks/store';\n\nexport interface AppRoute {\n    prefix: string;\n    render: (id?: string, active?: boolean) => React.ReactNode;\n}\n\ninterface Props extends RouteComponentProps<any> {\n    routes: AppRoute[];\n}\n\ninterface RouteSetterProps {\n    prefix: string;\n    setActive: (prefix: string, id: string) => void;\n}\n\nconst RouteSetter = (props: RouteSetterProps) => {\n    return <Route path={`${props.prefix}:id*`}\n        component={(p: RouteComponentProps) => {\n            const location = p.location.pathname;\n            const id = location.substr(props.prefix.length);\n\n            props.setActive(props.prefix, id);\n            return null;\n        }}>\n    </Route>\n}\n\nexport default withRouter((props: Props) => {\n    const store = useStore();\n    const [activeSlide, setActiveSlide] = useState(0);\n\n    const setActive = useCallback((prefix: string, id: string) => {\n        store.current[prefix] = id;\n\n        const slideIndex = props.routes.findIndex(r => r.prefix === prefix);\n        setActiveSlide(slideIndex);\n    }, [props.routes, setActiveSlide]);\n\n    return <>\n        <SwipeableView\n            activeIndex={activeSlide}\n            onSwiped={(n) => {\n            if (n === activeSlide) return;\n\n            const prefix = props.routes[n].prefix;\n            const path = store.current[prefix];\n\n            setActiveSlide((n + 1) % 2);\n            props.history.push(`${prefix}${path || ''}`)\n        }}>\n            {props.routes.map((r, i) => <div\n                style={{ width: '100vw', height: '90vh', overflow: 'hidden auto', paddingTop: '10px' }}\n                key={r.prefix}>\n                {r.render(store.current[r.prefix], activeSlide === i)}\n            </div>)}\n        </SwipeableView>\n        {props.routes.map(r => <RouteSetter key={r.prefix} prefix={r.prefix} setActive={setActive}/>)}\n        <Route path='/' exact={true} component={() => {\n            setActiveSlide(1);\n            return null;\n        }}/>\n    </>\n});","export const debounce = (f: (...args) => void, time: number) => {\n    let timeout;\n\n    const invoke = (...args) => {\n        clearTimeout(timeout);\n        timeout = setTimeout(() => f(...args), time);\n    }\n    \n    return invoke;\n}","import { Settings } from \"../types/RecollectStore\";\nimport { getStore } from \"../hooks/store\";\nimport { debounce } from \"../services/debounce\";\n\nconst defaultSettings: Settings = {\n    markOpenedAsRead: true,\n    markScrolledAsRead: true,\n    doubleTapToCloseArticles: true,\n    unreadOnly: true,\n    fontSize: 3,\n    darkMode: false\n}\n\nconst saveSettings = (settings: Settings) => {\n    window.localStorage.setItem('settings', JSON.stringify(settings));\n    console.log('saved settings!');\n}\nconst debouncedSaveSettings = debounce(saveSettings, 1000);\n\nexport const updateSettings = <T extends keyof Settings>(name: T, value: Settings[T]) => {\n    getStore().settings[name] = value;\n    debouncedSaveSettings(getStore().settings);\n}\n\nexport const loadSettings = () => {\n    const json = window.localStorage.getItem('settings');\n    return json ? JSON.parse(json) as Settings : defaultSettings;\n}","import * as React from 'react';\nimport { List, ListItem, ListItemText, ListItemSecondaryAction, Switch, Divider } from '@material-ui/core';\nimport { Slider } from '@material-ui/lab';\nimport { makeStyles } from '@material-ui/styles';\nimport { getStore, useStore } from './hooks/store';\nimport { updateSettings } from './actions/settings';\nimport { useCallback } from 'react';\n\nconst useStyles = makeStyles({\n    slider: {\n        width: '48px !important'\n    }\n});\n\nexport default (props) => {\n    const styles = useStyles();\n    const store = useStore();\n\n    const onSwitchChange = React.useCallback((e: React.ChangeEvent<HTMLInputElement>, value: boolean) => {\n        const setting = e.target['name'];\n        updateSettings(setting as any, value)\n    }, []);\n\n    const onFontSizeChange = useCallback((e: React.ChangeEvent<{}>, value: any) => {\n        updateSettings('fontSize', value);\n    }, []);\n\n    return <div>\n        <List>\n            <ListItem>\n                <ListItemText\n                    primary='Read opened articles'\n                    secondary='Marks articles as read when you open them.' />\n                <ListItemSecondaryAction>\n                    <Switch\n                        checked={store.settings.markOpenedAsRead}\n                        name='markOpenedAsRead'\n                        onChange={onSwitchChange} />\n                </ListItemSecondaryAction>\n            </ListItem>\n            <ListItem>\n                <ListItemText\n                    primary='Auto mark as read'\n                    secondary='Marks articles as read when you scoll past them.' />\n                <ListItemSecondaryAction>\n                    <Switch checked={store.settings.markScrolledAsRead}\n                        name='markScrolledAsRead'\n                        onChange={onSwitchChange} />\n                </ListItemSecondaryAction>\n            </ListItem>\n            <ListItem>\n                <ListItemText\n                    primary='Double tap to close articles'\n                    secondary='Whether articles can be closed by double tapping them.' />\n                <ListItemSecondaryAction>\n                    <Switch checked={store.settings.doubleTapToCloseArticles}\n                        name='doubleTapToCloseArticles'\n                        onChange={onSwitchChange}/>\n                </ListItemSecondaryAction>\n            </ListItem>\n            <Divider />\n            <ListItem>\n                <ListItemText\n                    primary=\"Article Text Size\"\n                    secondary=\"Controls the size of the article text\" />\n                <ListItemSecondaryAction>\n                    <Slider\n                        className={styles.slider}\n                        min={1}\n                        max={5}\n                        step={1}\n                        onChange={onFontSizeChange}\n                        value={store.settings.fontSize} />\n                </ListItemSecondaryAction>\n            </ListItem>\n        </List>\n    </div>;\n}","import { Card, CardContent, CardHeader, CardMedia, Paper, Typography } from \"@material-ui/core\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport React from 'react';\nimport { Entry } from \"./model/entry\";\nimport { getEntryByline, getEntrySummary, getEntryVisualUrl } from \"./services/entry\";\n\nconst useStyles = makeStyles({\n    paper: {\n        cursor: 'pointer',\n        position: 'relative'\n    },\n    card: {\n        maxHeight: '500px'\n    },\n    read: {\n        color: '#F0F0F0 !important'\n    },\n    unread: {\n\n    },\n    tint: {\n        background: '#FFFFFF',\n        opacity: 0.6,\n        top: '0',\n        left: '0',\n        bottom: '0',\n        right: '0',\n        position: 'absolute'\n    }\n});\n\nexport default (props: { entry: Entry, showingUnreadOnly?: boolean }) => {\n    const styles = useStyles();\n\n    const visualUrl = getEntryVisualUrl(props.entry);\n    const subheader = getEntryByline(props.entry);\n    const summary = getEntrySummary(props.entry);\n\n    // Tint unread articles if and only if they are read and only unread articles are meant to be displayed.\n    const tintGray = !props.entry.unread && props.showingUnreadOnly;\n\n    return <Paper className={styles.paper}>\n            <Card className={styles.card}>\n                <CardHeader\n                    title={props.entry.title}\n                    subheader={subheader}/>\n\n                {visualUrl && <CardMedia\n                    src={visualUrl}\n                    component='img'\n                    title=\"Visual\"\n                    />}\n                {summary && <CardContent>\n                    <Typography component=\"small\">\n                        <div dangerouslySetInnerHTML={{ __html: summary }}></div>\n                    </Typography>\n                </CardContent>}\n            </Card>\n            {tintGray && <div className={styles.tint}></div>}\n        </Paper>;\n}","import { store as s } from 'react-recollect';\nimport { Stream } from '../model/stream';\nimport { Subscription } from '../model/subscription';\nimport { StoreDef, StoreStream } from '../types/RecollectStore';\nimport { Entry } from '../model/entry';\nimport { getUncategorizedId, getSavedId, getAllId } from '../api/streams';\nimport { getStore } from '../hooks/store';\nimport { saveChildren, loadStore } from './persister';\nimport { loadSettings } from '../actions/settings';\nimport { loadProfile } from '../actions/profile';\nconst store = s as StoreDef;\n \nexport const initStore = () => {\n    store.streams = {};\n    store.entries = {};\n    store.updating = {\n        categories: false,\n        profile: false,\n    };\n    store.settings = loadSettings();\n    store.current = {\n    };\n\n    loadStore();\n\n    // Include our fake stream by default.\n    // setAllStreams(store.profile.id, require('../fakeStream.json'));\n    // store.collections = require('../fakeCollections.json');\n}\n\nexport const setStream = (stream: Stream) => {\n    const entryUpdate = stream.items.reduce((prev, next) => ({\n        ...prev,\n        [next.id]: next\n    }), {});\n\n    store.entries = {\n        ...store.entries,\n        ...entryUpdate\n    };\n\n    store.streams[stream.id] = {\n        ...stream,\n        items: stream.items.map(i => i.id),\n        lastFetched: Date.now()\n    };\n}\n\nexport const getStream = (streamId: string): Stream => {\n    const store = getStore();\n    const stream = store.streams[streamId];\n    if (!stream) return;\n    return {\n        ...stream,\n        items: stream.items\n            .map(i => store.entries[i])\n            .filter(e => e)\n            .filter(e => e.unread || !store.settings.unreadOnly)\n    };\n}\n\nexport const getTaggedEntriesAsStream = (tag: string): Stream => {\n    const store = getStore();\n    return {\n        id: tag,\n        title: tag,\n        items: Object.values(store.entries)\n            .filter(e => e.unread || !store.settings.unreadOnly)\n    }\n}\n\nexport const setAllStreams = (profileId: string, allStream: Stream) => {\n    const uncategorizedId = getUncategorizedId(profileId);\n    const savedId = getSavedId(profileId);\n\n    const entryUpdate: { [id: string]: Entry } = {};\n    const streamUpdate = {\n        [allStream.id]: {\n            ...allStream,\n            items: allStream.items.map(i => i.id),\n            lastFetched: Date.now()\n        },\n        [uncategorizedId]: {\n            id: uncategorizedId,\n            title: \"Uncategorized\",\n            items: [],\n            lastFetched: 0\n        },\n        [savedId]: {\n            id: savedId,\n            title: \"Saved for later\",\n            items: [],\n            lastFetched: 0\n        }\n    };\n\n    for (const entry of allStream.items) {\n        entryUpdate[entry.id] = entry;\n\n        // Add to uncategorized.\n        if (!entry.categories || entry.categories.length === 0) {\n            streamUpdate[uncategorizedId].items.push(entry.id);\n            continue;\n        }\n        \n        // Add to all categories we pretend to have.\n        for (const category of entry.categories) {\n            // If we haven't made a stream for this category, create one.\n            if (!streamUpdate[category.id]) {\n                const oldStream = store.streams[category.id];\n\n                streamUpdate[category.id] = {\n                    id: category.id,\n                    title: category.label,\n                    items: [...(oldStream ? oldStream.items : [])],\n                    lastFetched: oldStream ? oldStream.lastFetched : 0\n                }\n            }\n\n            streamUpdate[category.id].items.push(entry.id);\n        }\n    }\n\n    // Deduplicate items.\n    for (const category of Object.values(streamUpdate)) {\n        category.items = Array.from(new Set(category.items));\n    }\n\n    store.entries = {\n        ...store.entries,\n        ...entryUpdate\n    };\n\n    store.streams = {\n        ...store.streams,\n        ...streamUpdate\n    }\n\n    Promise.all([\n        saveChildren('streams', streamUpdate),\n        saveChildren('entries', entryUpdate)\n    ]);\n}\n\nconst ensureStream = (id: string, title: string, on: { [id: string]: StoreStream }) => {\n    if (on[id])\n      return;\n\n    on[id] = {\n        id: id,\n        title: title,\n        items: [],\n        lastFetched: 0\n    }\n};\n\nexport const updateWithStream = async (stream: Stream) => {\n    const profile = await loadProfile();\n    const store = getStore();\n\n    const allId = getAllId(profile.id);\n    const savedId = getSavedId(profile.id);\n    const uncategorizedId = getUncategorizedId(profile.id);\n\n    const newStreams: { [id: string]: StoreStream } = { };\n    for (const oldStream of Object.values(store.streams)) {\n        newStreams[oldStream.id] = {\n            ...oldStream,\n            items: [...oldStream.items]\n        };\n    }\n\n    const newEntries = {};\n\n    ensureStream(allId, \"All\", newStreams);\n    ensureStream(savedId, \"Saved for later\", newStreams);\n    ensureStream(uncategorizedId, \"Uncategorized\", newStreams);\n\n    for (const entry of stream.items) {\n        newEntries[entry.id] = entry;\n\n        // Add to all.\n        newStreams[allId].items.push(entry.id);\n\n        // Maybe add to uncategorized.\n        if (!entry.categories || entry.categories.length === 0) {\n            newStreams[uncategorizedId].items.push(entry.id);\n            continue;\n        }\n\n        // Add the entry to each category it says it belongs to.\n        for (const category of entry.categories) {\n            ensureStream(category.id, category.label, newStreams);\n            newStreams[category.id].items.push(entry.id);\n        }\n    }\n\n    // Deduplicate.\n    for (const category of Object.values(newStreams))\n        category.items = Array.from(new Set(category.items));\n    \n    // Update the store.\n    getStore().entries = {\n        ...getStore().entries,\n        ...newEntries\n    };\n    getStore().streams = newStreams;\n\n    // Save to disk.\n    Promise.all([\n        saveChildren('streams', getStore().streams),\n        saveChildren('entries', getStore().entries)\n    ]);\n};","import { Store } from \"react-recollect\";\nimport { getStore } from \"../hooks/store\";\nimport { getAllId, getStream, StreamRequestOptions } from \"../api/streams\";\nimport { updateProfile, loadProfile } from \"./profile\";\nimport { setAllStreams, updateWithStream } from \"../services/store\";\n\nexport const updateStreams = async (streamId?: string, unreadOnly: boolean = false, thenSync: boolean = false) => {\n    if (!getStore().profile)\n        await updateProfile();\n\n    streamId = streamId || getAllId(getStore().profile.id);\n    if (getStore().updating[streamId]) return;\n    getStore().updating[streamId] = true;\n\n    try {\n        const stream = await getStream(streamId, 'contents', { unreadOnly });\n\n        // TODO: We should have a better set all streams method.\n        updateWithStream(stream);\n\n        // Maybe update all streams in the background.\n        if (thenSync)\n            getAllUnread();\n    } catch (error) {\n        window.snackHelper.enqueueSnackbar(\"Unable to update stream. You appear to be offline.\")\n    }\n    getStore().updating[streamId] = false;\n}\n\nexport const getAllUnread = async (continuation: string = undefined) => {\n    const profile = await loadProfile();\n    const streamId = getAllId(profile.id);\n\n    try {\n        do {\n            const options: StreamRequestOptions = {\n                unreadOnly: true\n            };\n            if (continuation)\n                options.continuation = continuation;\n\n            const stream = await getStream(streamId, 'contents', options);\n\n            // Next time, start from here.\n            continuation = stream.continuation;\n            updateWithStream(stream);\n        } while (continuation);\n    } catch (error) {\n        window.snackHelper.enqueueSnackbar('Background update failed.');\n    }\n\n    window.snackHelper.enqueueSnackbar('Background sync complete.');\n}","import { makeStyles } from \"@material-ui/styles\";\nimport * as React from 'react';\n\nconst useStyles = makeStyles({\n    root: {\n        display: 'flex',\n        justifyContent: 'center'\n    }\n});\n\nexport default props => {\n    const styles = useStyles();\n\n    return <div className={styles.root}>\n        {props.children}\n    </div>\n}","import * as React from 'react';\nimport { useRef, useState } from 'react';\nimport { debounce } from '../services/debounce';\nimport { RootRef } from '@material-ui/core';\n\ninterface Props {\n    getContainer: (node: HTMLElement) => HTMLElement;\n    children: (visible: boolean) => React.ReactNode;\n}\n\nconst isAbove = (container: HTMLElement, element: HTMLElement) => {\n    if (!container || !element) return false;\n\n    const elementRect = element.getBoundingClientRect();\n    const containerRect = container.getBoundingClientRect();\n\n    return elementRect.bottom < containerRect.top;\n}\nexport const ScrollVisibility = (props: Props) => {\n    const elementRef = useRef<HTMLDivElement>(null);\n    const [scrollContainer, setScrollContainer] = useState(null);\n    const [scrollHandler, setScrollHandler] = useState(null);\n    const [above, setAbove] = useState(false);\n\n    React.useEffect(() => {\n        if (!elementRef || !elementRef.current) return;\n\n        // TODO: This doesn't seem to be removing the handler?\n        if (scrollContainer && scrollHandler)\n            scrollContainer.removeEventListener('scroll', scrollHandler);\n        \n        const handler = e => {\n            const newAbove = isAbove(scrollContainer, elementRef.current);\n\n            // Debouncing isn't working, don't trigger rerender.\n            if (newAbove !== above) setAbove(newAbove);\n        };\n\n        const debounced = debounce(handler, 1000);\n\n        const container = props.getContainer(elementRef.current);\n        setScrollContainer(container);\n        setScrollHandler(debounced);\n        container.addEventListener('scroll', debounced, { passive: true })\n        \n        return () => {\n            scrollContainer && scrollHandler && scrollContainer.removeEventListener('scroll', scrollHandler);\n        }\n    }, [props.getContainer, elementRef]);\n\n\n\n    return <RootRef rootRef={elementRef}>\n        {props.children(!above)}\n    </RootRef>;\n}","import { makeStyles } from \"@material-ui/styles\";\nimport * as React from 'react';\n\nconst useStyles = makeStyles({\n    stickyHeader: {\n        position: 'sticky',\n        top: 0\n    }\n});\n\ninterface Props extends React.HTMLProps<HTMLDivElement> {\n}\n\nexport default (props: Props) => {\n    const styles = useStyles();\n    const { children, className, ...rest } = props;\n\n    return <div className={`${className} ${styles.stickyHeader}`} {...rest}>\n        {children}\n    </div>;\n}","import { CircularProgress, Grid, IconButton, Switch, FormControlLabel, LinearProgress } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/styles';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { RouteComponentProps, withRouter } from 'react-router';\nimport EntryCard from \"./EntryCard\";\nimport { useStream } from './hooks/stream';\nimport { useStore, isUpdating } from './hooks/store';\nimport AppBarButton from './components/AppBarButton';\nimport { Refresh } from '@material-ui/icons';\nimport { updateStreams } from './actions/stream';\nimport { getStream } from './services/store';\nimport Centre from './components/Centre';\nimport { Entry } from './model/entry';\nimport { History } from 'history';\nimport { ScrollVisibility } from './components/ScrollVisibility';\nimport { setUnread } from './actions/marker';\nimport StickyHeader from './components/StickyHeader';\n\nconst useStyles = makeStyles({\n  root: {\n  },\n  loadingButton: {\n    color: 'white !important'\n  },\n  loader: {\n    marginBottom: \"10px\",\n  },\n  header: {\n    top: '-10px',\n    zIndex: 1000,\n    margin: '-10px -10px 10px -10px'\n  }\n});\n\ntype Props = RouteComponentProps<any> & {\n  id: string;\n  active: boolean;\n};\n\nconst MarkEntryAsRead = (props: { entry: Entry }) => {\n  useEffect(() => {\n    if (!props.entry || !props.entry.unread) return;\n\n    setUnread(props.entry, false);\n  }, [props.entry && props.entry.id])\n\n  return null;\n}\n\nexport default withRouter((props: Props) => {\n  const streamId = props.id;\n  const stream = useStream(streamId);\n\n  useEffect(() => {\n    if (!streamId || stream && stream.id !== streamId) return;\n    updateStreams(streamId);\n  }, [streamId]);\n\n  return <EntriesViewer\n    entries={stream && stream.items}\n    id={streamId}\n    history={props.history}\n    active={props.active} />\n});\n\nconst EntriesViewer = (props: { entries: Entry[], id: string, active: boolean, history: History }) => {\n  const store = useStore();\n  const styles = useStyles();\n  const markScrolledAsRead = store.settings.markScrolledAsRead;\n\n  const loading = !props.entries || isUpdating(props.id);\n  const [entryIdsToKeep, setEntryIdsToKeep] = useState<{ [id: string]: boolean }>({});\n\n  const getSuitableEntries = (keep = {}) => {\n    if (!props.entries)\n      return [];\n\n    const entries = props.entries\n      .filter(e => e && (e.unread || !store.settings.unreadOnly || keep[e.id]));\n\n    entries.sort((a, b) => b.published - a.published);\n    return entries;\n  }\n\n  // When the current viewed stream changes, reset the entries to keep.\n  useEffect(() => {\n    setEntryIdsToKeep(getSuitableEntries().reduce((prev, next) => {\n      prev[next.id] = true;\n      return prev;\n    }, {}));\n  }, [props.id, store.settings.unreadOnly]);\n\n  // Only recalculate suitable entries if something important changes,\n  // not only if we mark articles as read.\n  // In addition, make sure we don't hide any entries in the list if we receive\n  // new ones.\n  const suitableEntries = useMemo(() => getSuitableEntries(entryIdsToKeep),\n    [props.entries && props.entries.length,\n    props.id,\n    store.settings.unreadOnly,\n    store.updating[props.id],\n    entryIdsToKeep]);\n\n  const unreadCount = useMemo(() => suitableEntries.filter(e => e.unread).length, [props.entries]);\n  const readProgress = (1 - unreadCount / suitableEntries.length) * 100;\n  return <div className={styles.root}>\n    {store.settings.unreadOnly\n      && !!suitableEntries.length\n      && <StickyHeader className={styles.header}>\n        <LinearProgress variant='determinate' value={readProgress} color='secondary' />\n      </StickyHeader>}\n    {loading && <Centre>\n      <CircularProgress className={styles.loader} />\n    </Centre>}\n    <Grid spacing={24} container justify='center' wrap='wrap'>\n      {suitableEntries\n        .map(e => <ScrollVisibility key={e.id}\n          getContainer={n => n.parentElement.parentElement.parentElement}>\n          {(visible) => <Grid item lg={3} md={6} sm={6} xs={12} onClick={() => props.history.push(`/entries/${e.id}`)}>\n            <EntryCard entry={e} showingUnreadOnly={store.settings.unreadOnly} />\n            {!visible && markScrolledAsRead && <MarkEntryAsRead entry={e} />}\n          </Grid>}\n        </ScrollVisibility>)}\n    </Grid>\n    {props.active && <>\n      <AppBarButton>\n        <IconButton disabled={loading} onClick={() => updateStreams(props.id, false, true)}>\n          <Refresh />\n        </IconButton>\n      </AppBarButton>\n      <AppBarButton>\n        <FormControlLabel\n          control={<Switch checked={store.settings.unreadOnly} onClick={() => store.settings.unreadOnly = !store.settings.unreadOnly} />}\n          label=\"Unread\" />\n      </AppBarButton>\n    </>}\n  </div>\n}","import { useEffect } from \"react\";\nimport { getStream, getAllStreams } from \"../api/streams\";\nimport { Entry } from \"../model/entry\";\nimport { Stream } from \"../model/stream\";\nimport { setAllStreams } from \"../services/store\";\nimport { useStore } from \"./store\";\nimport { executeOnce } from \"./promise\";\nimport { useProfile } from \"./profile\";\n\nexport const useStreams = () => {\n    const store = useStore();\n    const profile = useProfile();\n\n    const streams = store.streams;\n\n    // If we haven't the streams, get them from the internet.\n    executeOnce((profileId) => {\n        if (!profileId) return;\n\n        return !streams && getAllStreams(profileId).then(streams => setAllStreams(profileId, streams));\n    }, profile && profile.id);\n\n    return streams;\n}\n\nexport const useStream = (streamId: string): Stream => {\n    const store = useStore();\n    if (!streamId) return;\n    \n    const streams = store.streams;\n\n    // If it's a feed\n    if (streamId.startsWith('feed/')) {\n        return {\n            id: streamId,\n            items: Object.values(store.entries).filter(e => e.origin.streamId === streamId),\n            title: 'Feed'\n        };\n    }\n\n    // If it's a tag\n    if (streamId.includes('/tag/')) {\n        return {\n            id: streamId,\n            items: Object.values(store.entries).filter(e => e.tags && e.tags.some(t => t.id === streamId)),\n            title: 'Tag'\n        };\n    }\n    const stream = streams[streamId];\n\n    return stream\n        ? {\n            ...stream,\n            items: stream.items.map(i => store.entries[i])\n        }\n        : undefined;\n}\n\nexport const useEntries = (): Entry[] => {\n    const store = useStore();\n    useStreams();\n\n    return Object.values(store.entries);\n}\n\nexport const useEntry = (entryId: string): Entry => {\n    const store = useStore();\n    useStreams();\n\n    return store.entries[entryId];\n}\n\nexport const useFeeds = (feedId: string): Entry[] => {\n    const entries = useEntries();\n    return entries.filter(e => e.origin.streamId === feedId);\n}","import { MuiThemeProvider } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/styles';\nimport { SnackbarProvider } from 'notistack';\nimport React, { useEffect, useMemo } from 'react';\nimport { BrowserRouter } from 'react-router-dom';\nimport { getAllId } from './api/streams';\nimport AppBar from './AppBar';\nimport { SnackbarHelper } from './components/SnackbarHelper';\nimport EntryViewer from './EntryViewer';\nimport { useProfile } from './hooks/profile';\nimport { useStore } from './hooks/store';\nimport RouteManager, { AppRoute } from './RouteManager';\nimport SettingsPage from './SettingsPage';\nimport StreamViewer from './StreamViewer';\nimport { buildTheme } from './theme';\nimport \"./api/markers\";\nimport { getAllUnread } from './actions/stream';\n\nconst useStyles = makeStyles({\n  root: {\n    width: '100vw',\n    height: '100vw'\n  }\n});\n\nconst routes: AppRoute[] = [\n  {\n    prefix: '/settings/',\n    render: () => <SettingsPage />\n  },\n  {\n    prefix: '/stream/',\n    render: (id, active) => <StreamViewer id={id} active={active} />\n  },\n  {\n    prefix: '/entries/',\n    render: (id, active) => <EntryViewer id={id} active={active} />\n  }\n];\n\ngetAllUnread();\n\nexport const App = (props) => {\n  const styles = useStyles();\n  const store = useStore();\n  const profile = useProfile();\n\n  const theme = useMemo(() => {\n    return buildTheme(store.settings);\n  }, [store.settings.fontSize]);\n\n  useEffect(() => {\n    if (store.current['/stream/'] || !profile) return;\n\n    store.current['/stream/'] = getAllId(profile.id);\n  }, [store.current, profile]);\n\n  return <BrowserRouter>\n    <MuiThemeProvider theme={theme}>\n      <SnackbarProvider>\n        <SnackbarHelper/>\n        <div className={styles.root}>\n          <AppBar />\n          <RouteManager routes={routes} />\n        </div>\n      </SnackbarProvider>\n    </MuiThemeProvider>\n  </BrowserRouter>;\n};\n\nexport default App;\n","import { createMuiTheme } from \"@material-ui/core\";\nimport { Settings } from \"./types/RecollectStore\";\n\nexport const buildTheme = (settings: Settings) => createMuiTheme({\n    palette: {\n        type: settings.darkMode ? 'dark' : 'light',\n        primary: {\n            main: '#2BB24C'\n        },\n    },\n    typography: {\n        fontSize: 8 + (settings.fontSize * 2)\n    }\n});","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport { initStore } from './services/store';\nimport * as serviceWorker from './serviceWorker';\n\n// Make sure our store is initialized.\ninitStore();\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}